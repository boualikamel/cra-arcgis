(function(){(this||window).webpackJsonpareactgis.registerAbsMids({"esri/layers/graphics/OptimizedGeometry":70,"esri/layers/graphics/OptimizedFeature":107,"esri/layers/graphics/OptimizedFeatureSet":156,"esri/core/pbf":291,"esri/tasks/operations/queryAttachments":429,"esri/tasks/QueryTask":439,"esri/tasks/operations/queryRelatedRecords":440,"esri/layers/graphics/sources/StreamLayerSource":2368,"esri/layers/support/WebSocketConnector":2369})})(),(this.webpackJsonpareactgis=this.webpackJsonpareactgis||[]).push([[84,112],{107:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(21)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t,r,n){void 0===e&&(e=null),void 0===t&&(t={}),this.localId=0,this.geohashIndexed=!1,this.geohashX=0,this.geohashY=0,this.geometry=e,t&&(this.attributes=t),r&&(this.centroid=r),null!=n&&(this.objectId=n)};t.default=n}.apply(null,n))||(e.exports=i)},156:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1};t.default=r}.apply(null,n))||(e.exports=i)},2368:function(e,t,r){var n,i;n=[r(497),r(65),r(337),r(39),r(50),r(28),r(86),r(2369),r(439),r(51)],void 0===(i=function(e,t,r,n,i,o,s,a,c,u){return e([t,r.EsriPromise],{declaredClass:"esri.layers.graphics.sources.StreamLayerSource",constructor:function(e){var t=e&&e.layer;t&&(this.url=t.url)},initialize:function(){this.addResolvingPromise(this._fetchLayers())},properties:{connectionInfo:{get:function(){if(this.layer.hasMemorySource||this.layer.socketUrl)return{serviceSocketUrls:[this.layer.socketUrl]};if(this.sourceJSON){var e,t,r,n,o={},s=this.sourceJSON,a=[],c=[],u=[];if(s.streamUrls&&s.streamUrls.forEach((function(e){"ws"===e.transport&&(a=e.urls,o.token=e.token)}),this),a.forEach((function(e){0===e.lastIndexOf("wss",0)?u.push(e):c.push(e)})),(e="https"===i.appUrl.scheme||0===this.url.lastIndexOf("https:",0)?u:0===c.length?u:c)&&e.length>1)for(t=0;t<e.length-1;t++)n=e[r=t+Math.floor(Math.random()*(e.length-t))],e[r]=e[t],e[t]=n;return o.serviceSocketUrls=e,o}}},latestUrl:{get:function(){var e=this.sourceJSON,t=e.keepLatestArchive&&e.keepLatestArchive.featuresUrl;return t||null}},latestQueryTask:{get:function(){var e=this.latestUrl;return e?new c(e):null}},layer:{},relatedFeaturesInfo:{get:function(){var e=(this.sourceJSON||{}).relatedFeatures;return e&&e.featuresUrl?e:null}},relatedFeaturesQueryTask:{get:function(){var e=this.relatedFeaturesInfo,t=e?e.featuresUrl:null;return t?new c(t):null}},parsedUrl:{get:function(){return this.url?i.urlToObject(this.url):null}},url:null},createWebSocketConnector:function(e){var t=o.createDeferred();return this.when(function(){var r,i,o,s,c=this.connectionInfo,u=this.layer.spatialReference,h={};try{r=this.makeFilter()}catch(e){return void t.reject(e)}if(c){if(c.socketUrl?o=[c.socketUrl]:c.serviceSocketUrls&&(o=c.serviceSocketUrls.map(function(e){return e+"/"+this.layer.socketDirection}.bind(this))),h.socketUrls=o,r&&(r.where||r.geometry||r.outFields)){var l=r.geometry;l&&"string"!=typeof l&&(l=l.toJSON?JSON.stringify(l.toJSON()):JSON.stringify(l)),i=n.mixin(i||{},{where:r.where,geometry:l,outFields:r.outFields})}c.token&&(i=n.mixin(i||{},{token:c.token})),e&&u&&e.wkid!==u.wkid&&(i=n.mixin(i||{},{outSR:e.wkid})),h.queryParams=i,h.layerSource=this,s=new a(h),t.resolve(s)}else t.reject(new Error("No web socket urls found"))}.bind(this)),t.promise},getWebSocketToken:function(){return this._fetchStreamLayer().then(function(e){var t=e.data,r=null;return t.streamUrls&&t.streamUrls.some((function(e){if("ws"===e.transport)return r=e.token,!0}),this),r}.bind(this))},makeFilter:function(e){var t,r=this.layer,i=null;if(e){var o;if(t={},e.hasOwnProperty("where")&&(t.where=e.where),e.hasOwnProperty("geometry")){if((o=e.geometry)&&!o.hasOwnProperty("xmin"))throw new Error("Cannot make filter. Only Extent is supported for the geometry filter");o&&!o.declaredClass&&(o=new s(o)),t.geometry=o}}else{var a=r.filter||{};t={where:a.where,geometry:a.geometry};var c=this.relatedFeaturesInfo&&this.relatedFeaturesInfo.outFields||r.outFields;if(c&&-1===c.indexOf("*")){var u=r.fields.map((function(e){return e.name}));i=c.filter((function(e){return-1!==u.indexOf(e)})).join(","),t=n.mixin(t||{},{outFields:i})}}return t},queryFeatures:function(e,t){return o.reject()},_fetchLayers:function(){return this._fetchStreamLayer().then(function(e){return e.ssl&&(this.url=this.url.replace(/^http:/i,"https:")),this.sourceJSON=e.data,this._fetchArchiveLayer()}.bind(this)).then(function(e){return this.archivedLayerDefinition=e&&e.data,this._fetchRelatedLayer()}.bind(this)).then(function(e){this.relatedLayerDefinition=e&&e.data}.bind(this))},_fetchStreamLayer:function(){return this._requestServiceDefinition({url:this.layer.parsedUrl.path,content:n.mixin({f:"json"},this.layer.parsedUrl.query)})},_fetchArchiveLayer:function(){var e=this.latestUrl;return e?this._requestServiceDefinition({url:e}):o.resolve()},_fetchRelatedLayer:function(){var e=this.relatedFeaturesInfo;return e?this._requestServiceDefinition({url:e.featuresUrl}):o.resolve()},_requestServiceDefinition:function(e){return e&&e.url?u(e.url,{query:n.mixin(e.content||{},{f:"json"}),responseType:"json"}):o.reject(new Error("url is a required options property"))}})}.apply(null,n))||(e.exports=i)},2369:function(e,t,r){var n,i;n=[r(90),r(337),r(50),r(28),r(82),r(27)],void 0===(i=function(e,t,r,n,i,o){return(0,t.EsriPromiseMixin)(e.EventedAccessor).createSubclass({declaredClass:"esri.layers.support.WebSocketConnector",initialize:function(){var e=null;this.socketUrls.length||(e=new Error("No urls passed to WebSocketConnector. No live connection possible")),"WebSocket"in window||(e=new Error("The browser does not support Web Sockets. No live connection possible")),e&&this.addResolvingPromise(n.reject(e)),this.queryParams&&this.queryParams.token&&this._set("tokenNeeded",!0)},_socket:null,_connectPromise:null,_disconnectPromise:null,properties:{currentSocketUrl:{value:null,readOnly:!0},layerSource:null,queryParams:null,socketUrls:{value:[]},tokenNeeded:{value:!1},connectionError:{value:null,type:o,readOnly:!0},connectionStatus:{value:"disconnected",readOnly:!0}},connect:function(){var e=this.connectionStatus;return"connected"===e||"connecting"===e?this._connectPromise:"disconnected"===this.connectionStatus?(this._set("connectionStatus","connecting"),this._connect()):"disconnecting"===this.connectionStatus?(this._connectPromise=null,this._disconnectPromise||(this._disconnectPromise=i.once(this,"connectionStatus").then(function(e){if("disconnected"===e.value)return this._connect()}.bind(this))),this._disconnectPromise):void 0},disconnect:function(){var e=this.connectionStatus;"connected"===e?(this._set("connectionStatus","disconnecting"),this._socket?this._socket.close():this._set("connectionStatus","disconnected")):"connecting"===e&&this._connectPromise.then(function(){this.disconnect()}.bind(this))},send:function(e){this._socket&&("object"==typeof e&&(e=JSON.stringify(e)),this._socket.send(e))},_connect:function(){this._connectPromise&&(this._connectPromise=null);var e=n.createDeferred();return this._connectPromise=e,this._getWebSocketToken().then(function(e){e&&(this.queryParams.token=e);var t=this._makeCurrentUrl(),r=new WebSocket(t);r.onopen=this._handleSocketOpen.bind(this),r.onclose=this._handleSocketClose.bind(this),r.onmessage=this._handleSocketMessage.bind(this),this._socket=r}.bind(this)).catch(function(e){var t=new o("web-socket-connector:connect","Could not get websocket token for secured service",e);this._set("connectionError",t),this._connectPromise.reject(t)}.bind(this)),e.promise},_getWebSocketToken:function(){var e=this.queryParams,t=e&&e.token,r=this.tokenNeeded;return t?n.resolve(t):r?this.layerSource.getWebSocketToken():n.resolve()},_makeCurrentUrl:function(){var e,t,n=this.queryParams,i=this.socketUrls;return 1!==i.length&&this.currentSocketUrl?(e=i.indexOf(this.currentSocketUrl),t=i[e>=i.length-1?0:e+1]):t=i[0],this._set("currentSocketUrl",t),n&&(t+="?"+r.objectToQuery(n)),t},_handleSocketOpen:function(){this._set("connectionStatus","connected"),this._set("connectionError",null),this._disconnectPromise=null,this._connectPromise&&this._connectPromise.resolve()},_handleSocketClose:function(e){var t,r=null;this.queryParams&&(this.queryParams.token=null),e.wasClean&&!e.code||(1001===e.code?t="Service is going away.":4400===e.code?t=e.reason||"Invalid url parameters. Check filter properties.":4404===e.code?t="Service not found":4401===e.code||4403===e.code?t="Not authorized":e.wasClean||(t=e.reason||"Unknown reason"),t&&(r=new o("web-socket-connector:connection closed","Connection failed: "+t),this._set("connectionError",r),this._connectPromise&&this._connectPromise.reject(r))),this._connectPromise=null,this._set("connectionStatus","disconnected"),this._socket=null},_handleSocketMessage:function(e){this.emit("data-received",e.data)}})}.apply(null,n))||(e.exports=i)},291:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(36),r(177)],void 0===(i=function(e,t,r,n){var i=r("esri-text-decoder")?new TextDecoder("utf-8"):null,o=r("safari")||r("ios")?6:r("ff")?12:32;return function(){function e(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=e?e.byteLength:0),this._tag=0,this._dataType=99,this.init(e,t,r,n)}return e.prototype.init=function(e,t,r,n){this._data=e,this._dataView=t,this._pos=r,this._end=n},e.prototype.clone=function(){return new e(this._data,this._dataView,this._pos,this._end)},e.prototype.pos=function(){return this._pos},e.prototype.next=function(e){for(;;){if(this._pos===this._end)return!1;var t=this._decodeVarint();if(this._tag=t>>3,this._dataType=7&t,!e||e===this._tag)break;this.skip()}return!0},e.prototype.empty=function(){return this._pos>=this._end},e.prototype.tag=function(){return this._tag},e.prototype.getInt32=function(){return this._decodeVarint()},e.prototype.getInt64=function(){return this._decodeVarint()},e.prototype.getUInt32=function(){var e=4294967295;return e=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?e:(e=(e|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?e:void 0))))},e.prototype.getUInt64=function(){return this._decodeVarint()},e.prototype.getSInt32=function(){var e=this.getUInt32();return e>>>1^-(1&e)|0},e.prototype.getSInt64=function(){return this._decodeSVarint()},e.prototype.getBool=function(){var e=0!==this._data[this._pos];return this._skip(1),e},e.prototype.getEnum=function(){return this._decodeVarint()},e.prototype.getFixed64=function(){var e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+4294967296*e.getUint32(t+4,!0);return this._skip(8),r},e.prototype.getSFixed64=function(){var e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+4294967296*e.getInt32(t+4,!0);return this._skip(8),r},e.prototype.getDouble=function(){var e=this._dataView.getFloat64(this._pos,!0);return this._skip(8),e},e.prototype.getFixed32=function(){var e=this._dataView.getUint32(this._pos,!0);return this._skip(4),e},e.prototype.getSFixed32=function(){var e=this._dataView.getInt32(this._pos,!0);return this._skip(4),e},e.prototype.getFloat=function(){var e=this._dataView.getFloat32(this._pos,!0);return this._skip(4),e},e.prototype.getString=function(){var e=this._getLength(),t=this._pos,r=this._toString(this._data,t,t+e);return this._skip(e),r},e.prototype.getBytes=function(){var e=this._getLength(),t=this._pos,r=this._toBytes(this._data,t,t+e);return this._skip(e),r},e.prototype.processMessageWithArgs=function(e,t,r,n){var i=this.getMessage(),o=e(i,t,r,n);return i.release(),o},e.prototype.processMessage=function(e){var t=this.getMessage(),r=e(t);return t.release(),r},e.prototype.getMessage=function(){var t=this._getLength(),r=e.pool.acquire();return r.init(this._data,this._dataView,this._pos,this._pos+t),this._skip(t),r},e.prototype.release=function(){e.pool.release(this)},e.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw new Error("Invalid data type!")}},e.prototype._skip=function(e){if(this._pos+e>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=e},e.prototype._decodeVarint=function(){var e,t=this._data,r=this._pos,n=0;if(this._end-r>=10)do{if(n|=127&(e=t[r++]),0==(128&e))break;if(n|=(127&(e=t[r++]))<<7,0==(128&e))break;if(n|=(127&(e=t[r++]))<<14,0==(128&e))break;if(n|=(127&(e=t[r++]))<<21,0==(128&e))break;if(n+=268435456*(127&(e=t[r++])),0==(128&e))break;if(n+=34359738368*(127&(e=t[r++])),0==(128&e))break;if(n+=4398046511104*(127&(e=t[r++])),0==(128&e))break;if(n+=562949953421312*(127&(e=t[r++])),0==(128&e))break;if(n+=72057594037927940*(127&(e=t[r++])),0==(128&e))break;if(n+=0x8000000000000000*(127&(e=t[r++])),0==(128&e))break;throw new Error("Varint too long!")}while(0);else{for(var i=1;r!==this._end&&0!=(128&(e=t[r]));)++r,n+=(127&e)*i,i*=128;if(r===this._end)throw new Error("Varint overrun!");++r,n+=e*i}return this._pos=r,n},e.prototype._decodeSVarint=function(){var e=this._decodeVarint();return e%2?-(e+1)/2:e/2},e.prototype._getLength=function(){if(2!==this._dataType)throw new Error("Not a delimited data type!");return this._decodeVarint()},e.prototype._toString=function(e,t,r){if((r=Math.min(this._end,r))-t>o&&i){var n=e.subarray(t,r);return i.decode(n)}for(var s="",a="",c=t;c<r;++c){var u=e[c];128&u?a+="%"+u.toString(16):(s+=decodeURIComponent(a)+String.fromCharCode(u),a="")}return a.length&&(s+=decodeURIComponent(a)),s},e.prototype._toBytes=function(e,t,r){return r=Math.min(this._end,r),new Uint8Array(e.buffer,t,r-t)},e.pool=new n(e,!1,(function(e){e._data=null,e._dataView=null})),e}()}.apply(null,n))||(e.exports=i)},429:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(26),r(51),r(50),r(502),r(382)],void 0===(i=function(e,t,r,n,i,o,s){Object.defineProperty(t,"__esModule",{value:!0}),t.processAttachmentQueryResult=function(e,t){for(var r={},n=0,s=e;n<s.length;n++)for(var a=s[n],c=a.parentObjectId,u=a.parentGlobalId,h=0,l=a.attachmentInfos;h<l.length;h++){var d=l[h],p=d.id,f=i.addProxy(i.addTokenParameter(t+"/"+c+"/attachments/"+p)),y=o.fromJSON(d);y.set({url:f,parentObjectId:c,parentGlobalId:u}),r[c]?r[c].push(y):r[c]=[y]}return r},t.executeAttachmentQuery=function(e,t,i){var o={query:s.mapParameters(r({},e.query,{f:"json"},function(e){var t=e.toJSON();return t.attachmentTypes&&(t.attachmentTypes=t.attachmentTypes.join(",")),t.keywords&&(t.keywords=t.keywords.join(",")),t.globalIds&&(t.globalIds=t.globalIds.join(",")),t.objectIds&&(t.objectIds=t.objectIds.join(",")),t.size&&(t.size=t.size.join(",")),t}(t)))};return i&&(o=r({},i,o)),n(e.path+"/queryAttachments",o)}}.apply(null,n))||(e.exports=i)},439:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(22),r(20),r(316),r(26),r(48),r(23),r(395),r(422),r(429),r(440),r(423),r(185),r(158),r(424)],void 0===(i=function(e,t,r,n,i,o,s,a,c,u,h,l,d,p,f,y){return function(e){function t(t){var r=e.call(this,t)||this;return r.gdbVersion=null,r.source=null,r}return r(t,e),t.prototype.execute=function(e,t){return this.executeJSON(e,t).then((function(e){return p.fromJSON(e)}))},t.prototype.executeJSON=function(e,t){return u.executeQuery(this.parsedUrl,this._normalizeQuery(e),o({},this.requestOptions,t)).then((function(e){return e.data}))},t.prototype.executeForCount=function(e,t){return u.executeQueryForCount(this.parsedUrl,this._normalizeQuery(e),o({},this.requestOptions,t)).then((function(e){return e.data.count}))},t.prototype.executeForExtent=function(e,t){return u.executeQueryForExtent(this.parsedUrl,this._normalizeQuery(e),o({},this.requestOptions,t)).then((function(e){return{count:e.data.count,extent:s.Extent.fromJSON(e.data.extent)}}))},t.prototype.executeForIds=function(e,t){return u.executeQueryForIds(this.parsedUrl,this._normalizeQuery(e),o({},this.requestOptions,t)).then((function(e){return e.data.objectIds}))},t.prototype.executeRelationshipQuery=function(e,t){return e=y.from(e),(this.gdbVersion||this.source)&&(e=e.clone().set({gdbVersion:this.gdbVersion||e.gdbVersion,source:this.source||e.source})),l.executeRelationshipQuery(this.parsedUrl,e,o({},this.requestOptions,t)).then((function(e){var t=e.data,r={};return Object.keys(t).forEach((function(e){return r[e]=p.fromJSON(t[e])})),r}))},t.prototype.executeAttachmentQuery=function(e,t){var r=this;return h.executeAttachmentQuery(this.parsedUrl,d.from(e),o({},this.requestOptions,t)).then((function(e){return h.processAttachmentQueryResult(e.data.attachmentGroups,r.parsedUrl.path)}))},t.prototype._normalizeQuery=function(e){var t=f.from(e);return this.gdbVersion||this.source?(t===e?t.clone():t).set({gdbVersion:this.gdbVersion||e.gdbVersion,source:this.source||e.source}):t},n([a.property()],t.prototype,"gdbVersion",void 0),n([a.property()],t.prototype,"source",void 0),n([a.subclass("esri.tasks.QueryTask")],t)}(a.declared(c))}.apply(null,n))||(e.exports=i)},440:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(26),r(51),r(382)],void 0===(i=function(e,t,r,n,i){function o(e){var t=e.toJSON();return t.objectIds&&(t.objectIds=t.objectIds.join(",")),t.outFields&&(t.outFields=t.outFields.join(",")),t.outSpatialReference&&(t.outSR=t.outSR.wkid||JSON.stringify(t.outSR.toJSON()),delete t.outSpatialReference),t.source&&(t.layer=JSON.stringify({source:t.source}),delete t.source),t}Object.defineProperty(t,"__esModule",{value:!0}),t.toQueryStringParameters=o,t.executeRelationshipQuery=function(e,t,s){var a={query:i.mapParameters(r({},e.query,{f:"json"},o(t)))};return s&&(a=r({},s,a)),n(e.path+"/queryRelatedRecords",a).then((function(e){for(var t=e.data,r=t.geometryType,n=t.spatialReference,i={},o=0,s=t.relatedRecordGroups;o<s.length;o++){var a=s[o],c={fields:void 0,objectIdFieldName:void 0,geometryType:r,spatialReference:n,features:a.relatedRecords};if(null!=a.objectId)i[a.objectId]=c;else for(var u in a)a.hasOwnProperty(u)&&"relatedRecords"!==u&&(i[a[u]]=c)}return e.data=i,e}))}}.apply(null,n))||(e.exports=i)},70:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]),this.lengths=e,this.coords=t};t.default=r}.apply(null,n))||(e.exports=i)}}]);
//# sourceMappingURL=84.c8542002.chunk.js.map