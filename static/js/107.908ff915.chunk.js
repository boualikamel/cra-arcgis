(function(){(this||window).webpackJsonpareactgis.registerAbsMids({"esri/renderers/support/heatmapUtils":654,"esri/views/2d/layers/features/tileRenderers/BaseTileRenderer":796,"esri/views/2d/layers/features/tileRenderers/HeatmapTileRenderer":1146,"esri/views/2d/layers/features/tileRenderers/support/HeatmapSource":2366})})(),(this.webpackJsonpareactgis=this.webpackJsonpareactgis||[]).push([[107],{1146:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(20),i(22),i(28),i(23),i(654),i(187),i(796),i(2366)],void 0===(r=function(e,t,i,n,r,a,o,s,l,u){Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){function t(t){var i=e.call(this,t)||this;i._intensityInfo={minPixelIntensity:0,maxPixelIntensity:0},i.featuresView={attributeView:{initialize:function(){},requestUpdate:function(){}},requestRender:function(){}};var n=t.layerView.clips;return i._container=new s.BitmapTileContainer(t.tileInfoView,t.layerView.clips),i.handles.add([n.on("change",(function(){return i._container.setClips(n)}))]),i}return n(t,e),t.prototype.createTile=function(e){var t=this._container.createTile(e);return this.tileInfoView.getTileCoords(t.bitmap,e),t.bitmap.resolution=this.tileInfoView.getTileResolution(e),t},t.prototype.onConfigUpdate=function(){var e=this,t=this.layer.renderer;if("heatmap"===t.type){var i=t.minPixelIntensity,n=t.maxPixelIntensity;this._intensityInfo.minPixelIntensity=i,this._intensityInfo.maxPixelIntensity=n,this._gradient=o.generateGradient(t.toJSON()),this.tiles.forEach((function(t){var r=t.bitmap.source;r&&(r.minPixelIntensity=i,r.maxPixelIntensity=n,r.gradient=e._gradient,t.bitmap.invalidateTexture())}))}},t.prototype.hitTest=function(){return r.resolve([])},t.prototype.install=function(e){e.addChild(this._container)},t.prototype.uninstall=function(e){this._container.removeAllChildren(),e.removeChild(this._container)},t.prototype.disposeTile=function(e){this._container.removeChild(e),e.destroy()},t.prototype.supportsRenderer=function(e){return e&&"heatmap"===e.type},t.prototype.onTileData=function(e){var t=this.tiles.get(e.tileKey);if(t){var i=e.intensityInfo,n=this._intensityInfo,r=n.minPixelIntensity,a=n.maxPixelIntensity,o=t.bitmap.source||new u.HeatmapSource;o.intensities=i&&i.matrix||null,o.minPixelIntensity=r,o.maxPixelIntensity=a,o.gradient=this._gradient,t.bitmap.source=o,this._container.addChild(t),this.requestUpdate()}},t.prototype.onTileError=function(e){console.error(e)},i([a.subclass("esri.views.2d.layers.features.tileRenderers.HeatmapTileRenderer")],t)}(a.declared(l.default));t.default=p}.apply(null,n))||(e.exports=r)},2366:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(654)],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.gradient=null,this.height=512,this.width=512}return e.prototype.render=function(e){i.drawHeatmap(e,512,this.intensities,this.gradient,this.minPixelIntensity,this.maxPixelIntensity)},e}();t.HeatmapSource=n}.apply(null,n))||(e.exports=r)},654:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(10),i(43)],void 0===(r=function(e,t,i,n){function r(e,t,i,r,a){for(var o=new Uint32Array(e*e),s=("buffer"in t?t:new Float64Array(t)),l=("buffer"in i?new Uint32Array(i.buffer):new Uint32Array(new Uint8Array(i).buffer)),u=l.length/(a-r),p=0;p<s.length;p++){var c=s[p],f=Math.floor((c-r)*u);o[p]=l[n.clamp(f,0,l.length-1)]}return o.buffer}function a(e){for(var t=Math.round(3*e),i=2*e*e,n=new Float64Array(2*t+1),r=0;r<=n.length;r++)n[r]=Math.exp(-Math.pow(r-t,2)/i)/Math.sqrt(2*Math.PI)*(e/2);return n}function o(e,t){return"function"==typeof e?e:e?"string"==typeof t?function(t){return-1*+t[e]}:function(i){return+i[e]+t}:function(){return 1}}Object.defineProperty(t,"__esModule",{value:!0}),t.generateGradient=function(){if(!("document"in i))return function(){return null};var e=document.createElement("canvas"),t=e.getContext("2d");return e.height=512,e.width=1,function(i){t.clearRect(0,0,1,e.height);for(var n=t.createLinearGradient(0,0,0,e.height),r=0,a=i.colorStops;r<a.length;r++){var o=a[r],s=o.ratio,l=o.color;n.addColorStop(Math.max(s,.001),"rgba("+l[0]+", "+l[1]+", "+l[2]+", "+l[3]+")")}return t.fillStyle=n,t.fillRect(0,0,1,e.height),t.getImageData(0,0,1,e.height).data}}(),t.calculateHeatmapIntensityInfo=function(e,t,i,n){for(var r,s=t.blurRadius,l=t.fieldOffset,u=t.field,p=new Float64Array(i*n),c=a(s),f=Math.round(3*s),d=Number.NEGATIVE_INFINITY,h=o(u,l),y=0,m=e;y<m.length;y++)for(var v=m[y],g=v.geometry,w=v.attributes,x=g.x-f,I=g.y-f,b=Math.max(0,x),T=Math.max(0,I),_=Math.min(n,g.y+f),P=Math.min(i,g.x+f),M=+h(w),R=T;R<_;R++)for(var U=c[R-I],A=b;A<P;A++){var V=c[A-x];(r=p[R*i+A]+=U*V*M)>d&&(d=r)}return{matrix:p.buffer,max:d}},t.drawHeatmap=function(e,t,i,n,a,o){e.canvas.width=e.canvas.height=t,e.clearRect(0,0,t,t);var s=e.getImageData(0,0,t,t);i&&n&&s.data.set(new Uint8ClampedArray(r(t,i,n,a,o))),e.putImageData(s,0,0)},t.createHeatmapImageData=r,t.createKernel=a,t.createValueFunction=o}.apply(null,n))||(e.exports=r)},796:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(22),i(20),i(297),i(23)],void 0===(r=function(e,t,i,n,r,a){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){var i=e.call(this,t)||this;return i.tiles=new Map,i}return i(t,e),t.prototype.destroy=function(){this.tiles.clear(),this.layer=this.layerView=this.tileInfoView=this.tiles=null},Object.defineProperty(t.prototype,"updating",{get:function(){return this.isUpdating()},enumerable:!0,configurable:!0}),t.prototype.acquireTile=function(e){var t=this,i=this.createTile(e);return i.once("isReady",(function(){return t.notifyChange("updating")})),this.tiles.set(e.id,i),i},t.prototype.lockAttributeTextureUpload=function(){},t.prototype.unlockAttributeTextureUpload=function(){},t.prototype.forceAttributeTextureUpload=function(){},t.prototype.forEachTile=function(e){this.tiles.forEach(e)},t.prototype.releaseTile=function(e){this.tiles.delete(e.key.id),this.disposeTile(e)},t.prototype.isUpdating=function(){var e=!0;return this.tiles.forEach((function(t){e=e&&t.isReady})),!e},t.prototype.setHighlight=function(){},t.prototype.invalidateLabels=function(){},t.prototype.requestUpdate=function(){this.layerView.requestUpdate()},n([a.property()],t.prototype,"layer",void 0),n([a.property()],t.prototype,"layerView",void 0),n([a.property()],t.prototype,"tileInfoView",void 0),n([a.property()],t.prototype,"updating",null),n([a.subclass("esri.views.2d.layers.features.tileRenderers.BaseTileRenderer")],t)}(a.declared(r.HandleOwner));t.default=o}.apply(null,n))||(e.exports=r)}}]);
//# sourceMappingURL=107.908ff915.chunk.js.map