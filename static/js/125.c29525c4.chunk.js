(function(){(this||window).webpackJsonpareactgis.registerAbsMids({"esri/views/3d/layers/PointCloudWorker":2006,"esri/views/3d/layers/i3s/PointCloudRendererUtil":2010})})(),(this.webpackJsonpareactgis=this.webpackJsonpareactgis||[]).push([[125],{2006:function(e,t,r){var o,n;o=[r.dj.c(e.i),t,r(21),r(33),r(28),r(331),r(459),r(388),r(627),r(629),r(286),r(717),r(59),r(2010),r(567),r.dj.m(e)],void 0===(n=function(e,t,r,o,n,a,i,l,u,f,s,c,d,v,b,p){Object.defineProperty(t,"__esModule",{value:!0});var h=function(){function e(){}return e.prototype._process=function(e){var t=this._transform(e),r=[t.points.buffer,t.rgb.buffer];o.isSome(t.pointIdFilterMap)&&r.push(t.pointIdFilterMap.buffer);for(var a=0,l=t.attributes;a<l.length;a++){var u=l[a];"buffer"in u.values&&i.isArrayBuffer(u.values.buffer)&&u.values.buffer!==t.rgb.buffer&&r.push(u.values.buffer)}return n.resolve({result:t,transferList:r})},e.prototype._transform=function(e){var t=v.readGeometry(e.schema,e.geometryBuffer),r=t.length/3,n=null,a=[],i=v.getAttributeValues(e.primaryAttributeData,t,r);o.isSome(e.primaryAttributeData)&&i&&a.push({attributeInfo:e.primaryAttributeData.attributeInfo,values:i});var l=v.getAttributeValues(e.modulationAttributeData,t,r);o.isSome(e.modulationAttributeData)&&l&&a.push({attributeInfo:e.modulationAttributeData.attributeInfo,values:l});var u=v.evaluateRenderer(e.rendererInfo,i,l,r);if(e.filterInfo&&e.filterInfo.length>0&&o.isSome(e.filterAttributesData)){var f=e.filterAttributesData.map((function(e){var o=v.getAttributeValues(e,t,r),n={attributeInfo:e.attributeInfo,values:o};return a.push(n),n}));n=new Uint32Array(r),r=v.filterInPlace(t,u,n,e.filterInfo,f)}for(var s=0,c=e.userAttributesData;s<c.length;s++){var b=c[s],p=v.getAttributeValues(b,t,r);a.push({attributeInfo:b.attributeInfo,values:p})}3*r<u.length&&(u=new Uint8Array(u.buffer.slice(0,3*r))),this._applyElevationOffsetInPlace(t,r,e.elevationOffset);var h=this._transformCoordinates(t,r,e.obb,d.fromJSON(e.inSR),d.fromJSON(e.outSR));return{obb:e.obb,points:h,rgb:u,attributes:a,pointIdFilterMap:n}},e.prototype._transformCoordinates=function(e,t,r,o,n){if(!b.bufferToBuffer(e,o,0,e,n,0,t))throw Error("Can't reproject");var a=c.vec3f32.fromValues(r.center[0],r.center[1],r.center[2]),i=c.vec3f32.create(),l=c.vec3f32.create();u.quat.conjugate(g,r.quaternion);for(var f=new Float32Array(3*t),d=0;d<t;d++)i[0]=e[3*d]-a[0],i[1]=e[3*d+1]-a[1],i[2]=e[3*d+2]-a[2],s.vec3.transformQuat(l,i,g),r.halfSize[0]=Math.max(r.halfSize[0],Math.abs(l[0])),r.halfSize[1]=Math.max(r.halfSize[1],Math.abs(l[1])),r.halfSize[2]=Math.max(r.halfSize[2],Math.abs(l[2])),f[3*d]=i[0],f[3*d+1]=i[1],f[3*d+2]=i[2];return f},e.prototype._applyElevationOffsetInPlace=function(e,t,r){if(0!==r)for(var o=0;o<t;o++)e[3*o+2]+=r},e}(),g=f.quatf32.create(),m=function(t){function o(){var r=t.call(this)||this;return r._thread=void 0,l.open(a.getAbsMid("./PointCloudWorker",e,p)).then((function(e){void 0===r._thread?r._thread=e:e.close()})),r}return r(o,t),o.prototype.destroy=function(){this._thread&&this._thread.close(),this._thread=null},o.prototype.transform=function(e,t,r){return this._thread?this._thread.invoke("_process",e,{transferList:t,signal:r}):n.resolve(this._transform(e))},o}(h);t.PointCloudWorker=m,t.default=function(){return new h}}.apply(null,o))||(e.exports=n)},2010:function(e,t,r){var o,n;o=[r.dj.c(e.i),t,r(33),r(718),r(720),r(721),r(722),r(903)],void 0===(n=function(e,t,r,o,n,a,i,l){function u(e){for(var t=0,r=0,o=e||[];r<o.length;r++)t|=1<<o[r];return t}function f(e,t){for(var r=0,o=e;r<o.length;r++){var n=o[r];if(n.name===t&&null!=n.attributeValues&&"UInt8"===n.attributeValues.valueType&&3===n.attributeValues.valuesPerElement)return{name:t,storageInfo:n,useElevation:!1}}return null}function s(e,t){for(var r=0,o=e;r<o.length;r++){var n=o[r];if(n.name===t){var a="embedded-elevation"===n.encoding;return{name:t,storageInfo:a?null:n,useElevation:a}}}return"elevation"===t.toLowerCase()?{name:t,storageInfo:null,useElevation:!0}:null}function c(e,t){for(var r=new Float64Array(t),o=0;o<t;o++)r[o]=e[3*o+2];return r}function d(e){return null==e||"none"===e?null:"low-four-bit"===e?function(e){return 15&e}:"high-four-bit"===e?function(e){return(240&e)>>4}:"absolute-value"===e?function(e){return Math.abs(e)}:"modulo-ten"===e?function(e){return e%10}:null}Object.defineProperty(t,"__esModule",{value:!0}),t.getRendererInfo=function(e){var t=e.renderer,r=t&&t.type,o=t&&e.renderer.toJSON()||null,n=null,a=!1;"point-cloud-unique-value"===r?n=s(e.attributeStorageInfo,t.field):"point-cloud-stretch"===r?n=s(e.attributeStorageInfo,t.field):"point-cloud-class-breaks"===r?n=s(e.attributeStorageInfo,t.field):"point-cloud-rgb"===r?a=null!=(n=f(e.attributeStorageInfo,t.field)):a=null!=(n=f(e.attributeStorageInfo,"RGB"));var i=null;return t&&t.colorModulation&&(i=s(e.attributeStorageInfo,t.colorModulation.field)),{rendererJSON:o,isRGBRenderer:a,primaryAttribute:n,modulationAttribute:i}},t.getFilterInfo=function(e){var t=e.filters;return t?t.map((function(t){return{filterJSON:t.toJSON(),attributeInfo:s(e.attributeStorageInfo,t.field)}})):[]},t.evaluateRenderer=function(e,t,r,i){var l=e.rendererJSON,u=e.isRGBRenderer,f=null,s=null;if(t&&u)f=t;else if(t&&"pointCloudUniqueValueRenderer"===l.type){var c=(s=a.fromJSON(l)).colorUniqueValueInfos;f=new Uint8Array(3*i);for(var v=d(s.fieldTransformType),b=0;b<i;b++)for(var p=(m=v?v(t[b]):t[b])+"",h=0;h<c.length;h++)if(c[h].values.indexOf(p)>=0){f[3*b]=c[h].color.r,f[3*b+1]=c[h].color.g,f[3*b+2]=c[h].color.b;break}}else if(t&&"pointCloudStretchRenderer"===l.type){var g=(s=n.fromJSON(l)).stops;f=new Uint8Array(3*i);for(v=d(s.fieldTransformType),b=0;b<i;b++){var m=v?v(t[b]):t[b],y=g.length-1;if(m<g[0].value)f[3*b]=g[0].color.r,f[3*b+1]=g[0].color.g,f[3*b+2]=g[0].color.b;else if(m>=g[y].value)f[3*b]=g[y].color.r,f[3*b+1]=g[y].color.g,f[3*b+2]=g[y].color.b;else for(h=1;h<g.length;h++)if(m<g[h].value){var S=(m-g[h-1].value)/(g[h].value-g[h-1].value);f[3*b]=g[h].color.r*S+g[h-1].color.r*(1-S),f[3*b+1]=g[h].color.g*S+g[h-1].color.g*(1-S),f[3*b+2]=g[h].color.b*S+g[h-1].color.b*(1-S);break}}}else if(t&&"pointCloudClassBreaksRenderer"===l.type){var I=(s=o.fromJSON(l)).colorClassBreakInfos;f=new Uint8Array(3*i);for(v=d(s.fieldTransformType),b=0;b<i;b++)for(m=v?v(t[b]):t[b],h=0;h<I.length;h++)if(m>=I[h].minValue&&m<=I[h].maxValue){f[3*b]=I[h].color.r,f[3*b+1]=I[h].color.g,f[3*b+2]=I[h].color.b;break}}else{f=new Uint8Array(3*i);for(b=0;b<f.length;b++)f[b]=255}if(r&&s&&s.colorModulation){var A=s.colorModulation.minValue,w=s.colorModulation.maxValue;for(b=0;b<i;b++){var M=(m=r[b])>=w?1:m<=A?.3:.3+.7*(m-A)/(w-A);f[3*b]=M*f[3*b],f[3*b+1]=M*f[3*b+1],f[3*b+2]=M*f[3*b+2]}}return f},t.filterInPlace=function(e,t,r,o,n){for(var a=e.length/3,i=0,l=0;l<a;l++){for(var f=!0,s=0;s<o.length&&f;s++){var c=o[s].filterJSON,d=n[s].values[l];switch(c.type){case"pointCloudValueFilter":var v="exclude"===c.mode;-1!==c.values.indexOf(d)===v&&(f=!1);break;case"pointCloudBitfieldFilter":var b=u(c.requiredSetBits),p=u(c.requiredClearBits);(d&b)===b&&0==(d&p)||(f=!1);break;case"pointCloudReturnFilter":for(var h=15&d,g=d>>>4&15,m=g>1,y=1===h,S=h===g,I=!1,A=0,w=c.includedReturns;A<w.length;A++){var M=w[A];if("last"===M&&S||"firstOfMany"===M&&y&&m||"lastOfMany"===M&&S&&m||"single"===M&&!m){I=!0;break}}I||(f=!1)}}f&&(r[i]=l,e[3*i]=e[3*l],e[3*i+1]=e[3*l+1],e[3*i+2]=e[3*l+2],t[3*i]=t[3*l],t[3*i+1]=t[3*l+1],t[3*i+2]=t[3*l+2],i++)}return i},t.getSplatSizeAlgorithm=function(e){var t=e&&e.pointSizeAlgorithm;return t&&"splat"===t.type?t:null},t.getFixedSizeAlgorithm=function(e){var t=e&&e.pointSizeAlgorithm;return t&&"fixed-size"===t.type?t:null},t.rendererUsesFixedSizes=function(e){var t=e&&e.pointSizeAlgorithm;return!(!t||!t.type)&&"fixed-size"===t.type},t.getAttributeInfo=s,t.elevationFromPositions=c,t.getAttributeValues=function(e,t,o){return r.isSome(e)&&e.attributeInfo.useElevation?c(t,o):r.isSome(e)?i.readBinaryAttribute(e.attributeInfo.storageInfo,e.buffer,o):null},t.readGeometry=function(e,t){if(null==e.encoding||""===e.encoding){for(var r=i.createGeometryIndexFromSchema(t,e),o=i.createTypedView(t,r.vertexAttributes.position),n=r.header.fields,a=[n.offsetX,n.offsetY,n.offsetZ],u=[n.scaleX,n.scaleY,n.scaleZ],f=o.length/3,s=new Float64Array(3*f),c=0;c<f;c++)s[3*c]=o[3*c]*u[0]+a[0],s[3*c+1]=o[3*c+1]*u[1]+a[1],s[3*c+2]=o[3*c+2]*u[2]+a[2];return s}if("lepcc-xyz"===e.encoding)return l.decodeXYZ(t).result}}.apply(null,o))||(e.exports=n)}}]);
//# sourceMappingURL=125.c29525c4.chunk.js.map