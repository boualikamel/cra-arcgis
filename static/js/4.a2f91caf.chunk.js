(function(){(this||window).webpackJsonpareactgis.registerAbsMids({"esri/layers/support/Field":112,"esri/layers/FeatureLayer":179,"esri/tasks/support/FeatureSet":185,"esri/layers/support/FieldsIndex":194,"esri/core/requireUtils":331,"esri/tasks/support/AttachmentQuery":423,"esri/tasks/support/RelationshipQuery":424,"esri/support/popupUtils":442,"esri/renderers/support/styleUtils":467,"esri/layers/support/TimeInfo":484,"esri/layers/support/FeatureReduction":485,"esri/layers/support/fieldProperties":486,"esri/layers/mixins/TemporalLayer":524,"esri/layers/support/TimeReference":525,"esri/layers/support/FeatureReductionSelection":526,"esri/layers/support/FeatureReductionCluster":581,"esri/layers/support/FeatureTemplate":582,"esri/layers/support/labelingInfo":583,"esri/layers/graphics/sources/MemorySource":755,"esri/layers/support/FeatureIndex":756,"esri/layers/support/featureReductionUtils":757,"esri/layers/support/FeatureType":758,"esri/layers/support/Relationship":759})})(),(this.webpackJsonpareactgis=this.webpackJsonpareactgis||[]).push([[4,122],{112:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(22),r(20),r(47),r(34),r(23),r(54),r(354),r(360)],void 0===(o=function(e,t,r,i,o,n,a,s,p,l){var u=new o.default({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});return function(e){function t(t){var r=e.call(this,t)||this;return r.alias=null,r.defaultValue=void 0,r.description=null,r.domain=null,r.editable=!0,r.length=-1,r.name=null,r.nullable=!0,r.type=null,r.valueType=null,r}var o;return r(t,e),o=t,t.prototype.readDescription=function(e,t){var r,i=t.description;try{r=JSON.parse(i)}catch(e){}return r?r.value:null},t.prototype.readValueType=function(e,t){var r,i=t.description;try{r=JSON.parse(i)}catch(e){}return r?u.fromJSON(r.fieldValueType):null},t.prototype.clone=function(){return new o({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType})},i([a.property({type:String,json:{write:!0}})],t.prototype,"alias",void 0),i([a.property({type:[String,Number],json:{write:{allowNull:!0}}})],t.prototype,"defaultValue",void 0),i([a.property()],t.prototype,"description",void 0),i([a.reader("description")],t.prototype,"readDescription",null),i([a.property({types:p.types,json:{read:{reader:p.fromJSON},write:!0}})],t.prototype,"domain",void 0),i([a.property({type:Boolean,json:{write:!0}})],t.prototype,"editable",void 0),i([a.property({type:s.Integer,json:{write:!0}})],t.prototype,"length",void 0),i([a.property({type:String,json:{write:!0}})],t.prototype,"name",void 0),i([a.property({type:Boolean,json:{write:!0}})],t.prototype,"nullable",void 0),i([a.enumeration.serializable()(l.kebabDict)],t.prototype,"type",void 0),i([a.property()],t.prototype,"valueType",void 0),i([a.reader("valueType",["description"])],t.prototype,"readValueType",null),o=i([a.subclass("esri.layers.support.Field")],t)}(a.declared(n.JSONSupport))}.apply(null,i))||(e.exports=o)},179:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(26),r(22),r(20),r(316),r(31),r(32),r(353),r(157),r(51),r(159),r(91),r(27),r(196),r(47),r(24),r(33),r(289),r(352),r(28),r(50),r(23),r(86),r(501),r(59),r(295),r(755),r(338),r(155),r(116),r(188),r(168),r(524),r(344),r(92),r(756),r(485),r(581),r(526),r(757),r(582),r(758),r(486),r(194),r(115),r(386),r(583),r(403),r(759),r(484),r(178),r(467),r(442),r(169),r(423),r(185),r(158),r(424),r(285)],void 0===(o=function(e,t,i,o,n,a,s,p,l,u,d,y,c,f,h,m,v,g,b,w,F,S,I,T,O,x,j,R,_,D,M,E,C,P,A,N,q,L,J,G,k,Q,U,V,z,B,W,Z,H,K,$,X,Y,ee,te,re,ie,oe,ne){function ae(e){return e&&e instanceof c}function se(e,t,r){return!!(e&&e.hasOwnProperty(t)?e[t]:r)}function pe(e,t,r){return e&&e.hasOwnProperty(t)?e[t]:r}var le=new m.default({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),ue={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"},de="FeatureLayer",ye=v.getLogger("esri.layers.FeatureLayer"),ce=V.defineFieldProperties();return function(e){function t(t){var r=e.call(this,t)||this;return r._handles=new h,r.capabilities=null,r.copyright=null,r.displayField=null,r.definitionExpression=null,r.dynamicDataSource=null,r.editFieldsInfo=null,r.editingEnabled=!0,r.editingInfo=null,r.elevationInfo=null,r.featureReduction=null,r.fields=null,r.fullExtent=null,r.gdbVersion=null,r.geometryProperties=null,r.geometryType=null,r.hasM=void 0,r.hasZ=void 0,r.heightModelInfo=null,r.historicMoment=null,r.isTable=!1,r.labelsVisible=!0,r.labelingInfo=null,r.layerId=void 0,r.legendEnabled=!0,r.minScale=0,r.maxScale=0,r.globalIdField=null,r.objectIdField=null,r.outFields=null,r.path=null,r.popupEnabled=!0,r.popupTemplate=null,r.relationships=null,r.sourceJSON=null,r.returnM=void 0,r.returnZ=void 0,r.screenSizePerspectiveEnabled=!0,r.serviceDefinitionExpression=null,r.spatialReference=x.WGS84,r.templates=null,r.timeInfo=null,r.title=null,r.sublayerTitleMode="item-title",r.trackIdField=null,r.type="feature",r.typeIdField=null,r.types=null,r.indexes=new(c.ofType(q.FeatureIndex)),r.userIsAdmin=!1,r.version=void 0,r.visible=!0,r}return o(t,e),t.prototype.destroy=function(){this._handles&&(this._handles.destroy(),this._handles=null)},t.prototype.normalizeCtorArgs=function(e,t){return"string"==typeof e?i({url:e},t):e},t.prototype.load=function(e){var t=this,r=g.isSome(e)?e.signal:null;if(!(this.portalItem&&this.portalItem.loaded&&this.source)){var i=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection"]},e).catch((function(e){return e})).then((function(){return p(t,void 0,void 0,(function(){var e,t;return s(this,(function(i){switch(i.label){case 0:return this.url&&null==this.layerId&&/FeatureServer|MapServer\/*$/i.test(this.url)?[4,this._fetchFirstLayerId(r)]:[3,2];case 1:null!=(e=i.sent())&&(this.layerId=e),i.label=2;case 2:if(!this.url&&!this._hasMemorySource())throw new f("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");return t=this._initLayerProperties,[4,this.createGraphicsSource(r)];case 3:return[2,t.apply(this,[i.sent()])]}}))}))}));return this.addResolvingPromise(i),this.when()}this.addResolvingPromise(this.createGraphicsSource(r).then((function(e){return t._initLayerProperties(e)})))},t.prototype.readCapabilities=function(e,t){return t=t.layerDefinition||t,{attachment:this._readAttachmentCapabilities(t.attachmentProperties),data:this._readDataCapabilities(t),metadata:this._readMetadataCapabilities(t),operations:this._readOperationsCapabilities(t.capabilities||e,t),query:this._readQueryCapabilities(t),queryRelated:this._readQueryRelatedCapabilities(t),editing:this._readEditingCapabilities(t)}},t.prototype.readEditingEnabled=function(e,t){return!t.layerDefinition||"Query"!==t.layerDefinition.capabilities},t.prototype.writeEditingEnabled=function(e,t){e||w.setDeepValue("layerDefinition.capabilities","Query",t)},t.prototype.readEditingInfo=function(e,t){var r=t.editingInfo;return r?{lastEditDate:null!=r.lastEditDate?new Date(r.lastEditDate):null}:null},t.prototype.readFeatureReduction=function(e,t,r){return k.read(e,t,r)},t.prototype.writeWebSceneFeatureReduction=function(e,t,r,i){k.writeTarget(e,t,"layerDefinition.featureReduction",i)},Object.defineProperty(t.prototype,"fieldsIndex",{get:function(){return new z(this.fields||[])},enumerable:!0,configurable:!0}),t.prototype.readIsTable=function(e,t){return"Table"===(t=t&&t.layerDefinition||t).type},Object.defineProperty(t.prototype,"hasService",{get:function(){return!this._hasMemorySource()},enumerable:!0,configurable:!0}),t.prototype.readMinScale=function(e,t){return t.effectiveMinScale||e||0},t.prototype.readMaxScale=function(e,t){return t.effectiveMaxScale||e||0},t.prototype.readGlobalIdFieldFromService=function(e,t){if((t=t.layerDefinition||t).globalIdField)return t.globalIdField;if(t.fields)for(var r=0,i=t.fields;r<i.length;r++){var o=i[r];if("esriFieldTypeGlobalID"===o.type)return o.name}},t.prototype.readObjectIdFieldFromService=function(e,t){if((t=t.layerDefinition||t).objectIdField)return t.objectIdField;if(t.fields)for(var r=0,i=t.fields;r<i.length;r++){var o=i[r];if("esriFieldTypeOID"===o.type)return o.name}},Object.defineProperty(t.prototype,"parsedUrl",{get:function(){var e=this.url?S.urlToObject(this.url):null;if(null!=e)if(null!=this.layerId)e.path=S.join(e.path,this.layerId.toString());else if(null!=this.dynamicDataSource){var t={source:H.sourceToJSON(this.dynamicDataSource)};e.query={layer:JSON.stringify(t)}}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultPopupTemplate",{get:function(){return this.createPopupTemplate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderer",{set:function(e){B.fixRendererFields(e,this.fields),this._set("renderer",e)},enumerable:!0,configurable:!0}),t.prototype.readRenderer=function(e,t,r){var i,o,n=(t=t.layerDefinition||t).drawingInfo&&t.drawingInfo.renderer||void 0;if(n)(i=X.read(n,t,r)||void 0)||ye.error("Failed to create renderer",{rendererDefinition:t.drawingInfo.renderer,layer:this,context:r});else if(t.defaultSymbol)te.read(t.defaultSymbol,t,r),t.types&&t.types.length?(i=new u.UniqueValueRenderer({defaultSymbol:o,field:t.typeIdField}),t.types.forEach((function(e){n.addUniqueValueInfo(e.id,te.read(e.symbol,e,r))}))):i=new u.SimpleRenderer({symbol:o});else if("Table"!==t.type){switch(t.geometryType){case"esriGeometryPoint":case"esriGeometryMultipoint":o=new y.SimpleMarkerSymbol;break;case"esriGeometryPolyline":o=new y.SimpleLineSymbol;break;case"esriGeometryPolygon":o=new y.SimpleFillSymbol}i=o&&new u.SimpleRenderer({symbol:o})}return i},t.prototype.writeRenderer=function(e,t,r,i){X.writeTarget(e,t,r,i)},t.prototype.writeWebSceneRenderer=function(e,t,r,i){X.writeTarget(e,t,"layerDefinition.drawingInfo.renderer",i)},Object.defineProperty(t.prototype,"source",{set:function(e){var t=this._get("source");t!==e&&(ae(t)&&this._resetMemorySource(t),ae(e)&&this._initMemorySource(e),this._set("source",e))},enumerable:!0,configurable:!0}),t.prototype.castSource=function(e){return e?Array.isArray(e)||e instanceof c?new R.default({layer:this,items:e}):e:null},t.prototype.readSource=function(e,t){var r=ie.fromJSON(t.featureSet);return new R.default({layer:this,items:r&&r.features||[]})},t.prototype.readTemplates=function(e,t){var r=t.editFieldsInfo,i=r&&r.creatorField,o=r&&r.editorField;return e=e&&e.map((function(e){return Q.fromJSON(e)})),this._fixTemplates(e,i),this._fixTemplates(e,o),e},t.prototype.readTitle=function(e,t){var r=t.layerDefinition&&t.layerDefinition.name||t.name,i=t.title||t.layerDefinition&&t.layerDefinition.title;if(r){var o=this.portalItem&&this.portalItem.title;if("item-title"===this.sublayerTitleMode)return this.url?A.titleFromUrlAndName(this.url,r):r;var n=r||this.url&&A.parse(this.url).title;if(!n)return;return"item-title-and-service-name"===this.sublayerTitleMode&&o&&(n=o+" - "+n),A.cleanTitle(n)}if("item-title"===this.sublayerTitleMode&&i)return i},t.prototype.readTitleFromWebMap=function(e,t){return t.title||t.layerDefinition&&t.layerDefinition.name},t.prototype.readTypeIdField=function(e,t){var r=(t=t.layerDefinition||t).typeIdField;if(r){var i=B.getField(t.fields,r);i&&(r=i.name)}return r},t.prototype.readTypes=function(e,t){var r=this;e=(t=t.layerDefinition||t).types;var i=t.editFieldsInfo,o=i&&i.creatorField,n=i&&i.editorField;return e&&e.map((function(e){return e=U.fromJSON(e),r._fixTemplates(e.templates,o),r._fixTemplates(e.templates,n),e}))},Object.defineProperty(t.prototype,"url",{set:function(e){var t=A.sanitizeUrlWithLayerId(this,e,ye);this._set("url",t.url),null!=t.layerId&&this._set("layerId",t.layerId)},enumerable:!0,configurable:!0}),t.prototype.writeUrl=function(e,t,r,i){A.writeUrlWithLayerId(this,e,null,t,i)},t.prototype.readVersion=function(e,t){return t.currentVersion?t.currentVersion:t.hasOwnProperty("capabilities")||t.hasOwnProperty("drawingInfo")||t.hasOwnProperty("hasAttachments")||t.hasOwnProperty("htmlPopupType")||t.hasOwnProperty("relationships")||t.hasOwnProperty("timeInfo")||t.hasOwnProperty("typeIdField")||t.hasOwnProperty("types")?10:9.3},t.prototype.readVisible=function(e,t){return t.layerDefinition&&null!=t.layerDefinition.defaultVisibility?!!t.layerDefinition.defaultVisibility:null!=t.visibility?!!t.visibility:void 0},t.prototype.addAttachment=function(e,t){var r=this;return this.load().then((function(){return r._checkAttachmentSupport(e)})).then((function(){if(!("addAttachment"in r.source))throw new f(de,"Layer source does not support addAttachment capability");return r.source.addAttachment(e,t)}))},t.prototype.updateAttachment=function(e,t,r){var i=this;return this.load().then((function(){return i._checkAttachmentSupport(e)})).then((function(){if(!("updateAttachment"in i.source))throw new f(de,"Layer source does not support updateAttachment capability");return i.source.updateAttachment(e,t,r)}))},t.prototype.applyEdits=function(e,t){return p(this,void 0,void 0,(function(){return s(this,(function(i){switch(i.label){case 0:return[4,new Promise((function(e,t){r.e(103).then(function(){var t=[r(1147)];e.apply(null,t)}.bind(this)).catch(t.bind(this))}))];case 1:return[2,i.sent().applyEdits(this,e,t)]}}))}))},t.prototype.on=function(e,t){return this.inherited(arguments,[e,t])},t.prototype.createPopupTemplate=function(e){return ee.createPopupTemplate(this,e)},t.prototype.createGraphicsSource=function(e){return p(this,void 0,void 0,(function(){var t,i;return s(this,(function(o){switch(o.label){case 0:return this._hasMemorySource()?(this.emit("graphics-source-create",{graphicsSource:this.source}),[2,this.source.load({signal:e})]):[4,F.create((function(e){return Promise.all([r.e(5),r.e(6),r.e(88)]).then(function(){var t=[r(1148)];e.apply(null,t)}.bind(this)).catch(r.oe)}))];case 1:return t=o.sent(),F.throwIfAborted(e),[4,new t.default({layer:this}).load({signal:e})];case 2:return i=o.sent(),this.emit("graphics-source-create",{graphicsSource:i}),[2,i]}}))}))},t.prototype.createQuery=function(){var e=new oe,t=this.get("capabilities.data");return e.gdbVersion=this.gdbVersion,e.historicMoment=this.historicMoment,e.returnGeometry=!0,t&&(t.supportsZ&&null!=this.returnZ&&(e.returnZ=this.returnZ),t.supportsM&&null!=this.returnM&&(e.returnM=this.returnM)),e.outFields=["*"],e.where=this.definitionExpression||"1=1",e.multipatchOption="multipatch"===this.geometryType?"xyFootprint":null,e},t.prototype.deleteAttachments=function(e,t){var r=this;return this.load().then((function(){return r._checkAttachmentSupport(e)})).then((function(){if(!("deleteAttachments"in r.source))throw new f(de,"Layer source does not support deleteAttachments capability");return r.source.deleteAttachments(e,t)}))},t.prototype.getFeatureType=function(e){var t=this.typeIdField,r=this.types;if(!t||!e)return null;var i=e.attributes?e.attributes[t]:void 0;if(null==i)return null;var o=null;return r.some((function(e){var t=e.id;return null!=t&&(t.toString()===i.toString()&&(o=e),!!o)})),o},t.prototype.getFieldDomain=function(e,t){var r,i=this,o=!1,n=t&&t.feature,a=n&&n.attributes,s=this.typeIdField&&a&&a[this.typeIdField];return null!=s&&this.types&&this.types.some((function(t){return t.id==s&&((r=t.domains&&t.domains[e])&&"inherited"===r.type&&(r=i._getLayerDomain(e),o=!0),!0)})),o||r||(r=this._getLayerDomain(e)),r},t.prototype.getField=function(e){return this.fieldsIndex.get(e)},t.prototype.queryAttachments=function(e,t){var r=this;return e=re.from(e),this.load().then((function(){if(!r.get("capabilities.data.supportsAttachment"))throw new f(de,"this layer doesn't support attachments");var t=e.attachmentTypes,i=e.objectIds,o=e.globalIds,n=e.num,a=e.size,s=e.start,p=e.where;if(!r.get("capabilities.operations.supportsQueryAttachments")){var l=i&&i.length>1,u=t&&t.length,d=o&&o.length,y=a&&a.length;if(l||u||d||y||n||s||p)throw new f(de,"when 'supportsQueryAttachments' is false, only objectIds of length 1 are supported",e)}if(!(i&&i.length||p))throw new f(de,"'objectIds' or 'where' are required to perform attachment query",e);if(!("queryAttachments"in r.source))throw new f(de,"Layer source does not support queryAttachments capability",e);return r.source.queryAttachments(e)}))},t.prototype.queryFeatures=function(e,t){var r=this;return this.load().then((function(){return r.source.queryFeatures(oe.from(e)||r.createQuery(),t)})).then((function(e){if(e&&e.features)for(var t=0,i=e.features;t<i.length;t++){var o=i[t];o.layer=o.sourceLayer=r}return e}))},t.prototype.queryObjectIds=function(e,t){var r=this;return this.load().then((function(){if(r.source.queryObjectIds)return r.source.queryObjectIds(oe.from(e)||r.createQuery(),t);throw new f(de,"Layer source does not support queryObjectIds capability")}))},t.prototype.queryFeatureCount=function(e,t){var r=this;return this.load().then((function(){if(r.source.queryFeatureCount)return r.source.queryFeatureCount(oe.from(e)||r.createQuery(),t);throw new f(de,"Layer source does not support queryFeatureCount capability")}))},t.prototype.queryExtent=function(e,t){var r=this;return this.load().then((function(){if(r.source.queryExtent)return r.source.queryExtent(oe.from(e)||r.createQuery(),t);throw new f(de,"Layer source does not support queryExtent capability")}))},t.prototype.queryRelatedFeatures=function(e,t){var r=this;return this.load().then((function(){if("queryRelatedFeatures"in r.source)return r.source.queryRelatedFeatures(ne.from(e),t);throw new f(de,"Layer source does not support queryRelatedFeatures capability")}))},t.prototype.read=function(e,t){var r=e.featureCollection;if(r){var i=r.layers;i&&1===i.length&&(this.inherited(arguments,[i[0],t]),null!=r.showLegend&&this.inherited(arguments,[{showLegend:r.showLegend},t]))}this.inherited(arguments,[e,t]),t&&"service"===t.origin&&this.revert(["objectIdField","fields","timeInfo"],"service")},t.prototype.write=function(e,t){return t&&("web-scene"===t.origin||"web-map"===t.origin)&&t.messages&&this.isTable?(t.messages.push(new f("layer:unsupported","Layers ("+this.title+", "+this.id+") of type '"+this.declaredClass+"' using a Table source cannot written to web scenes and web maps",{layer:this})),null):this.inherited(arguments)},t.prototype._checkAttachmentSupport=function(e){var t=e.attributes,r=this.objectIdField;return this.get("capabilities.data.supportsAttachment")?e?t?t[r]?void 0:F.reject(new f(de,"feature is missing the identifying attribute "+r)):F.reject(new f(de,"'attributes' are required on a feature to query attachments")):F.reject(new f(de,"A feature is required to add/delete/update attachments")):F.reject(new f(de,"this layer doesn't support attachments"))},t.prototype._getLayerDomain=function(e){if(!this.fields)return null;var t=null;return this.fields.some((function(r){return r.name===e&&(t=r.domain),!!t})),t},t.prototype._fetchFirstLayerId=function(e){return d(this.url,{query:{f:"json"},responseType:"json",signal:e}).then((function(e){var t=e.data;if(t)return Array.isArray(t.layers)&&t.layers.length>0?t.layers[0].id:Array.isArray(t.tables)&&t.tables.length>0?t.tables[0].id:void 0}))},t.prototype._initLayerProperties=function(e){return p(this,void 0,void 0,(function(){return s(this,(function(t){return this._set("source",e),e.sourceJSON&&(this.sourceJSON=e.sourceJSON,this.read(e.sourceJSON,{origin:"service",url:this.parsedUrl})),this._verifySource(),this._verifyFields(),B.fixRendererFields(this.renderer,this.fields),B.fixTimeInfoFields(this.timeInfo,this.fields),[2,Y.loadStyleRenderer(this,{origin:"service"})]}))}))},t.prototype._verifyFields=function(){var e=this.parsedUrl&&this.parsedUrl.path||"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+e+")"),this.isTable||this._hasMemorySource()||-1!==e.search(/\/FeatureServer\//i)||this.fields&&this.fields.some((function(e){return"geometry"===e.type}))||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+e+")")},t.prototype._fixTemplates=function(e,t){e&&e.forEach((function(e){var r=e.prototype&&e.prototype.attributes;r&&t&&delete r[t]}))},t.prototype._verifySource=function(){if(this._hasMemorySource()){if(this.url)throw new f("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url")}else if(!this.url)throw new f("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source")},t.prototype._initMemorySource=function(e){var t=this;e.forEach((function(e){e.layer=t,e.sourceLayer=t})),this._handles.add([e.on("after-add",(function(e){e.item.layer=t,e.item.sourceLayer=t})),e.on("after-remove",(function(e){e.item.layer=null,e.item.sourceLayer=null}))],"fl-source")},t.prototype._resetMemorySource=function(e){e.forEach((function(e){e.layer=null,e.sourceLayer=null})),this._handles.remove("fl-source")},t.prototype._hasMemorySource=function(){return!(this.url||!this.source)},t.prototype._readAttachmentCapabilities=function(e){var t={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1};return e&&Array.isArray(e)&&e.forEach((function(e){var r=ue[e.name];r&&(t[r]=!!e.isEnabled)})),t},t.prototype._readDataCapabilities=function(e){return{isVersioned:se(e,"isDataVersioned",!1),supportsAttachment:se(e,"hasAttachments",!1),supportsM:se(e,"hasM",!1),supportsZ:se(e,"hasZ",!1)}},t.prototype._readMetadataCapabilities=function(e){return{supportsAdvancedFieldProperties:se(e,"supportsFieldDescriptionProperty",!1)}},t.prototype._readOperationsCapabilities=function(e,t){var r=e?e.toLowerCase().split(",").map((function(e){return e.trim()})):[],i=-1!==r.indexOf("editing"),o=i&&-1!==r.indexOf("create"),n=i&&-1!==r.indexOf("delete"),a=i&&-1!==r.indexOf("update");return i&&!(o||n||a)&&(o=n=a=!0),{supportsCalculate:se(t,"supportsCalculate",!1),supportsTruncate:se(t,"supportsTruncate",!1),supportsValidateSql:se(t,"supportsValidateSql",!1),supportsAdd:o,supportsDelete:n,supportsEditing:i,supportsQuery:-1!==r.indexOf("query"),supportsQueryAttachments:se(t.advancedQueryCapabilities,"supportsQueryAttachments",!1),supportsResizeAttachments:se(t,"supportsAttachmentsResizing",!1),supportsSync:-1!==r.indexOf("sync"),supportsUpdate:a,supportsExceedsLimitStatistics:se(t,"supportsExceedsLimitStatistics",!1)}},t.prototype._readQueryCapabilities=function(e){var t=e.advancedQueryCapabilities,r=e.ownershipBasedAccessControlForFeatures,i=e.archivingInfo,o=(e.supportedQueryFormats||"").split(",").reduce((function(e,t){var r=t.toLowerCase().trim();return r&&e.add(r),e}),new Set);return{supportsStatistics:se(t,"supportsStatistics",e.supportsStatistics),supportsCentroid:se(t,"supportsReturningGeometryCentroid",!1),supportsDistance:se(t,"supportsQueryWithDistance",!1),supportsDistinct:se(t,"supportsDistinct",e.supportsAdvancedQueries),supportsExtent:se(t,"supportsReturningQueryExtent",!1),supportsGeometryProperties:se(t,"supportsReturningGeometryProperties",!1),supportsHavingClause:se(t,"supportsHavingClause",!1),supportsOrderBy:se(t,"supportsOrderBy",e.supportsAdvancedQueries),supportsPagination:se(t,"supportsPagination",!1),supportsQuantization:se(e,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:se(e,"supportsQuantizationEditMode",!1),supportsQueryGeometry:se(e,"supportsReturningQueryGeometry",!1),supportsResultType:se(t,"supportsQueryWithResultType",!1),supportsMaxRecordCountFactor:se(t,"supportsMaxRecordCountFactor",!1),supportsSqlExpression:se(t,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:se(e,"useStandardizedQueries",!1),supportsQueryByOthers:se(r,"allowOthersToQuery",!0),supportsHistoricMoment:se(i,"supportsQueryWithHistoricMoment",!1),supportsFormatPBF:o.has("pbf"),supportsDisjointSpatialRelationship:se(t,"supportsDisjointSpatialRel",!1),supportsCacheHint:se(t,"supportsQueryWithCacheHint",!1),maxRecordCountFactor:pe(e,"maxRecordCountFactor",void 0),maxRecordCount:pe(e,"maxRecordCount",void 0),standardMaxRecordCount:pe(e,"standardMaxRecordCount",void 0),tileMaxRecordCount:pe(e,"tileMaxRecordCount",void 0)}},t.prototype._readQueryRelatedCapabilities=function(e){var t=e.advancedQueryCapabilities,r=se(t,"supportsAdvancedQueryRelated",!1);return{supportsPagination:se(t,"supportsQueryRelatedPagination",!1),supportsCount:r,supportsOrderBy:r}},t.prototype._readEditingCapabilities=function(e){var t=e.ownershipBasedAccessControlForFeatures;return{supportsGeometryUpdate:se(e,"allowGeometryUpdates",!0),supportsGlobalId:se(e,"supportsApplyEditsWithGlobalIds",!1),supportsRollbackOnFailure:se(e,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:se(e,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:se(e,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:se(t,"allowAnonymousToDelete",!0),supportsDeleteByOthers:se(t,"allowOthersToDelete",!0),supportsUpdateByAnonymous:se(t,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:se(t,"allowOthersToUpdate",!0)}},n([I.property({readOnly:!0,json:{read:!1}})],t.prototype,"capabilities",void 0),n([I.reader("service","capabilities",["advancedQueryCapabilities","allowGeometryUpdates","allowUpdateWithoutMValues","archivingInfo","capabilities","hasAttachments","hasM","hasZ","maxRecordCount","maxRecordCountFactor","ownershipBasedAccessControlForFeatures","standardMaxRecordCount","supportedQueryFormats","supportsAdvancedQueries","supportsApplyEditsWithGlobalIds","supportsAttachmentsByUploadId","supportsAttachmentsResizing","supportsCalculate","supportsCoordinatesQuantization","supportsExceedsLimitStatistics","supportsFieldDescriptionProperty","supportsQuantizationEditMode","supportsRollbackOnFailureParameter","supportsStatistics","supportsTruncate","supportsValidateSql","tileMaxRecordCount","useStandardizedQueries"])],t.prototype,"readCapabilities",null),n([I.property({type:String,json:{read:{source:"layerDefinition.copyrightText"},origins:{service:{read:{source:"copyrightText"}}}}})],t.prototype,"copyright",void 0),n([I.property({type:String,json:{read:{source:"layerDefinition.displayField"},origins:{service:{read:{source:"displayField"}}}}})],t.prototype,"displayField",void 0),n([I.property({type:String,json:{origins:{service:{read:!1,write:!1}},read:{source:"layerDefinition.definitionExpression"},write:{target:"layerDefinition.definitionExpression"}}})],t.prototype,"definitionExpression",void 0),n([I.property({readOnly:!0,json:{read:te.read}})],t.prototype,"defaultSymbol",void 0),n([I.property()],t.prototype,"dynamicDataSource",void 0),n([I.property({readOnly:!0})],t.prototype,"editFieldsInfo",void 0),n([I.property({type:Boolean})],t.prototype,"editingEnabled",void 0),n([I.reader(["portal-item","web-map","web-scene"],"editingEnabled",["layerDefinition.capabilities"])],t.prototype,"readEditingEnabled",null),n([I.writer(["portal-item","web-map","web-scene"],"editingEnabled",{"layerDefinition.capabilities":{type:String}})],t.prototype,"writeEditingEnabled",null),n([I.property({readOnly:!0})],t.prototype,"editingInfo",void 0),n([I.reader("editingInfo")],t.prototype,"readEditingInfo",null),n([I.property(N.elevationInfo)],t.prototype,"elevationInfo",void 0),n([I.property({types:{key:"type",base:L.default,typeMap:{selection:G.default,cluster:J.default}},json:{write:{target:"layerDefinition.featureReduction"}}})],t.prototype,"featureReduction",void 0),n([I.reader("featureReduction",["layerDefinition.featureReduction"])],t.prototype,"readFeatureReduction",null),n([I.writer("web-scene","featureReduction",{"layerDefinition.featureReduction":{types:k.webSceneFeatureReductionTypes}})],t.prototype,"writeWebSceneFeatureReduction",null),n([I.property(i({},ce.fields,{json:{origins:{service:{read:!0}},read:{source:"layerDefinition.fields"}}}))],t.prototype,"fields",void 0),n([I.property({readOnly:!0,dependsOn:["fields"]})],t.prototype,"fieldsIndex",null),n([I.property({type:T,json:{origins:{service:{read:{source:"extent"}}},read:{source:"layerDefinition.extent"}}})],t.prototype,"fullExtent",void 0),n([I.property()],t.prototype,"gdbVersion",void 0),n([I.property({readOnly:!0})],t.prototype,"geometryProperties",void 0),n([I.property({type:["point","polygon","polyline","multipoint","multipatch","mesh"],json:{origins:{service:{read:le.read}},read:{source:"layerDefinition.geometryType",reader:le.read}}})],t.prototype,"geometryType",void 0),n([I.property({type:Boolean,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasM"}}})],t.prototype,"hasM",void 0),n([I.property({type:Boolean,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasZ"}}})],t.prototype,"hasZ",void 0),n([I.property({readOnly:!0,type:O})],t.prototype,"heightModelInfo",void 0),n([I.property({type:Date})],t.prototype,"historicMoment",void 0),n([I.property({json:{origins:{service:{read:!1},"portal-item":{read:!1}}}})],t.prototype,"id",void 0),n([I.property({readOnly:!0})],t.prototype,"isTable",void 0),n([I.reader("service","isTable",["type"]),I.reader("isTable",["layerDefinition.type"])],t.prototype,"readIsTable",null),n([I.property({dependsOn:["loaded","url","source"],readOnly:!0})],t.prototype,"hasService",null),n([I.property(N.labelsVisible)],t.prototype,"labelsVisible",void 0),n([I.property({type:[W],json:{origins:{service:{read:{source:"drawingInfo.labelingInfo",reader:Z.reader},write:{target:"drawingInfo.labelingInfo",enabled:!1}}},read:{source:"layerDefinition.drawingInfo.labelingInfo",reader:Z.reader},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],t.prototype,"labelingInfo",void 0),n([I.property(N.opacityDrawingInfo)],t.prototype,"opacity",void 0),n([I.property({type:Number,json:{origins:{service:{read:{source:"id"}}},read:!1}})],t.prototype,"layerId",void 0),n([I.property(N.legendEnabled)],t.prototype,"legendEnabled",void 0),n([I.property({type:["show","hide"]})],t.prototype,"listMode",void 0),n([I.property({type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.minScale"},write:{target:"layerDefinition.minScale"}}})],t.prototype,"minScale",void 0),n([I.reader("service","minScale",["minScale","effectiveMinScale"])],t.prototype,"readMinScale",null),n([I.property({type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.maxScale"},write:{target:"layerDefinition.maxScale"}}})],t.prototype,"maxScale",void 0),n([I.reader("service","maxScale",["maxScale","effectiveMaxScale"])],t.prototype,"readMaxScale",null),n([I.property({type:String})],t.prototype,"globalIdField",void 0),n([I.reader("globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"]),I.reader("service","globalIdField",["globalIdField","fields"])],t.prototype,"readGlobalIdFieldFromService",null),n([I.property({type:String})],t.prototype,"objectIdField",void 0),n([I.reader("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"]),I.reader("service","objectIdField",["objectIdField","fields"])],t.prototype,"readObjectIdFieldFromService",null),n([I.property({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],t.prototype,"operationalLayerType",void 0),n([I.property(ce.outFields)],t.prototype,"outFields",void 0),n([I.property({readOnly:!0,dependsOn:["layerId"]})],t.prototype,"parsedUrl",null),n([I.property({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],t.prototype,"path",void 0),n([I.property(N.popupEnabled)],t.prototype,"popupEnabled",void 0),n([I.property({type:l,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],t.prototype,"popupTemplate",void 0),n([I.property({readOnly:!0,dependsOn:["fields","title"]})],t.prototype,"defaultPopupTemplate",null),n([I.property({type:[K],readOnly:!0})],t.prototype,"relationships",void 0),n([I.property({types:u.rendererTypes,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}}},write:{target:"layerDefinition.drawingInfo.renderer"}}})],t.prototype,"renderer",null),n([I.reader("service","renderer",["drawingInfo.renderer","defaultSymbol","type"]),I.reader("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol","layerDefinition.type"])],t.prototype,"readRenderer",null),n([I.writer("renderer")],t.prototype,"writeRenderer",null),n([I.writer("web-scene","renderer",{"layerDefinition.drawingInfo.renderer":{types:u.webSceneRendererTypes}})],t.prototype,"writeWebSceneRenderer",null),n([I.property()],t.prototype,"sourceJSON",void 0),n([I.property({type:Boolean})],t.prototype,"returnM",void 0),n([I.property({type:Boolean})],t.prototype,"returnZ",void 0),n([I.property(N.screenSizePerspectiveEnabled)],t.prototype,"screenSizePerspectiveEnabled",void 0),n([I.property()],t.prototype,"source",null),n([I.cast("source")],t.prototype,"castSource",null),n([I.reader("portal-item","source",["featureSet"]),I.reader("web-map","source",["featureSet"])],t.prototype,"readSource",null),n([I.property({readOnly:!0,json:{origins:{service:{read:{source:"definitionExpression"}}}}})],t.prototype,"serviceDefinitionExpression",void 0),n([I.property({type:x,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:{source:"layerDefinition.extent.spatialReference"}}})],t.prototype,"spatialReference",void 0),n([I.property({type:[Q]})],t.prototype,"templates",void 0),n([I.reader("templates",["editFieldsInfo","creatorField","editorField","templates"])],t.prototype,"readTemplates",null),n([I.property({type:$})],t.prototype,"timeInfo",void 0),n([I.property()],t.prototype,"title",void 0),n([I.reader("service","title",["name"]),I.reader("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],t.prototype,"readTitle",null),n([I.reader("web-map","title",["layerDefinition.name","title"])],t.prototype,"readTitleFromWebMap",null),n([I.property({type:String})],t.prototype,"sublayerTitleMode",void 0),n([I.property({type:String,json:{read:{source:"timeInfo.trackIdField"}}})],t.prototype,"trackIdField",void 0),n([I.property({json:{read:!1}})],t.prototype,"type",void 0),n([I.property({type:String})],t.prototype,"typeIdField",void 0),n([I.reader("service","typeIdField"),I.reader("typeIdField",["layerDefinition.typeIdField"])],t.prototype,"readTypeIdField",null),n([I.property({type:[U]})],t.prototype,"types",void 0),n([I.reader("service","types",["types"]),I.reader("types",["layerDefinition.types"])],t.prototype,"readTypes",null),n([I.property({type:c.ofType(q.FeatureIndex),readOnly:!0})],t.prototype,"indexes",void 0),n([I.property(N.url)],t.prototype,"url",null),n([I.writer("url")],t.prototype,"writeUrl",null),n([I.property({readOnly:!0})],t.prototype,"userIsAdmin",void 0),n([I.property({json:{origins:{service:{read:!0}},read:!1}})],t.prototype,"version",void 0),n([I.reader("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"])],t.prototype,"readVersion",null),n([I.property({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility"}}}}})],t.prototype,"visible",void 0),n([I.reader("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],t.prototype,"readVisible",null),n([I.subclass("esri.layers.FeatureLayer")],t)}(I.declared(P.TemporalLayer(C.ScaleRangeLayer(E.RefreshableLayer(_.ArcGISService(D.OperationalLayer(M.PortalLayer(b.MultiOriginJSONMixin(j)))))))))}.apply(null,i))||(e.exports=o)},185:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(20),r(22),r(48),r(108),r(47),r(34),r(33),r(23),r(59),r(40),r(112)],void 0===(o=function(e,t,r,i,o,n,a,s,p,l,u,d,y){var c=new a.default({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent"}),f=function(e){function t(t){var r=e.call(this,t)||this;return r.displayFieldName=null,r.exceededTransferLimit=!1,r.features=[],r.fields=null,r.geometryType=null,r.hasM=!1,r.hasZ=!1,r.queryGeometry=null,r.spatialReference=null,r}return i(t,e),t.prototype.readFeatures=function(e,t){for(var r=u.fromJSON(t.spatialReference),i=[],o=0;o<e.length;o++){var a=e[o],s=n.fromJSON(a),l=a.geometry&&a.geometry.spatialReference;p.isSome(s.geometry)&&!l&&(s.geometry.spatialReference=r),i.push(s)}return i},t.prototype.writeGeometryType=function(e,t,r,i){if(e)c.write(e,t,r,i);else{var o=this.features;if(o)for(var n=0,a=o;n<a.length;n++){var s=a[n];if(s&&p.isSome(s.geometry))return void c.write(s.geometry.type,t,r,i)}}},t.prototype.writeSpatialReference=function(e,t){if(e)t.spatialReference=e.toJSON();else{var r=this.features;if(r)for(var i=0,o=r;i<o.length;i++){var n=o[i];n&&p.isSome(n.geometry)&&n.geometry.spatialReference&&(t.spatialReference=n.geometry.spatialReference.toJSON())}}},t.prototype.toJSON=function(e){var t=this.write(null);if(t.features&&Array.isArray(e)&&e.length>0)for(var r=0;r<t.features.length;r++){var i=t.features[r];if(i.geometry){var o=e&&e[r];i.geometry=o&&o.toJSON()||i.geometry}}return t},t.prototype.quantize=function(e){for(var t=e.scale,r=t[0],i=t[1],o=e.translate,n=o[0],a=o[1],s=this.features,l=this._getQuantizationFunction(this.geometryType,(function(e){return Math.round((e-n)/r)}),(function(e){return Math.round((a-e)/i)})),u=0,d=s.length;u<d;u++)l(p.expect(s[u].geometry))||(s.splice(u,1),u--,d--);return this.transform=e,this},t.prototype.unquantize=function(){var e=this,t=e.geometryType,r=e.features,i=e.transform;if(!i)return this;for(var o=i.translate,n=o[0],a=o[1],s=i.scale,l=s[0],u=s[1],d=this._getHydrationFunction(t,(function(e){return e*l+n}),(function(e){return a-e*u})),y=0,c=r;y<c.length;y++){var f=c[y].geometry;p.isSome(f)&&d(f)}return this},t.prototype._quantizePoints=function(e,t,r){for(var i,o,n=[],a=0,s=e.length;a<s;a++){var p=e[a];if(a>0){var l=t(p[0]),u=r(p[1]);l===i&&u===o||(n.push([l-i,u-o]),i=l,o=u)}else i=t(p[0]),o=r(p[1]),n.push([i,o])}return n.length>0?n:null},t.prototype._getQuantizationFunction=function(e,t,r){var i=this;return"point"===e?function(e){return e.x=t(e.x),e.y=r(e.y),e}:"polyline"===e||"polygon"===e?function(e){for(var o=d.isPolygon(e)?e.rings:e.paths,n=[],a=0,s=o.length;a<s;a++){var p=o[a],l=i._quantizePoints(p,t,r);l&&n.push(l)}return n.length>0?(d.isPolygon(e)?e.rings=n:e.paths=n,e):null}:"multipoint"===e?function(e){var o;return(o=i._quantizePoints(e.points,t,r)).length>0?(e.points=o,e):null}:"extent"===e?function(e){return e}:null},t.prototype._getHydrationFunction=function(e,t,r){return"point"===e?function(e){e.x=t(e.x),e.y=r(e.y)}:"polyline"===e||"polygon"===e?function(e){for(var i,o,n=d.isPolygon(e)?e.rings:e.paths,a=0,s=n.length;a<s;a++)for(var p=n[a],l=0,u=p.length;l<u;l++){var y=p[l];l>0?(i+=y[0],o+=y[1]):(i=y[0],o=y[1]),y[0]=t(i),y[1]=r(o)}}:"extent"===e?function(e){e.xmin=t(e.xmin),e.ymin=r(e.ymin),e.xmax=t(e.xmax),e.ymax=r(e.ymax)}:"multipoint"===e?function(e){for(var i,o,n=e.points,a=0,s=n.length;a<s;a++){var p=n[a];a>0?(i+=p[0],o+=p[1]):(i=p[0],o=p[1]),p[0]=t(i),p[1]=r(o)}}:void 0},r([l.property({type:String,json:{write:!0}})],t.prototype,"displayFieldName",void 0),r([l.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],t.prototype,"exceededTransferLimit",void 0),r([l.property({type:[n],json:{write:!0}})],t.prototype,"features",void 0),r([l.reader("features")],t.prototype,"readFeatures",null),r([l.property({type:[y],json:{write:!0}})],t.prototype,"fields",void 0),r([l.property({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:c.read}}})],t.prototype,"geometryType",void 0),r([l.writer("geometryType")],t.prototype,"writeGeometryType",null),r([l.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],t.prototype,"hasM",void 0),r([l.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],t.prototype,"hasZ",void 0),r([l.property({types:o.geometryTypes,json:{read:d.fromJSON,write:!0}})],t.prototype,"queryGeometry",void 0),r([l.property({type:u,json:{write:!0}})],t.prototype,"spatialReference",void 0),r([l.writer("spatialReference")],t.prototype,"writeSpatialReference",null),r([l.property({json:{write:!0}})],t.prototype,"transform",void 0),r([l.subclass("esri.tasks.support.FeatureSet")],t)}(l.declared(s.JSONSupport));return f.prototype.toJSON.isDefaultToJSON=!0,f||(f={}),f}.apply(null,i))||(e.exports=o)},194:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(21)],void 0===(o=function(e,t,r){function i(e){return"date"===e.type||"esriFieldTypeDate"===e.type}function o(e){return e.toLowerCase().trim()}return function(){function e(e){if(this.fields=e,this._fieldsMap=new Map,this._dateFieldsSet=new Set,this.dateFields=[],e){for(var t=[],r=0,n=e;r<n.length;r++){var a=n[r],s=a&&a.name;if(s){var p=o(s);this._fieldsMap.set(s,a),this._fieldsMap.set(p,a),t.push(p),i(a)&&(this.dateFields.push(a),this._dateFieldsSet.add(a))}}t.sort(),this.uid=t.join(",")}}return e.prototype.destroy=function(){this._fieldsMap.clear()},e.prototype.has=function(e){return null!=this.get(e)},e.prototype.get=function(e){return null!=e?this._fieldsMap.get(e)||this._fieldsMap.get(o(e)):void 0},e.prototype.isDateField=function(e){return this._dateFieldsSet.has(this.get(e))},e.prototype.normalizeFieldName=function(e){var t=this.get(e);if(t)return t.name},e}()}.apply(null,i))||(e.exports=o)},331:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(392),r(24),r(28)],void 0===(o=function(e,t,r,i,o){Object.defineProperty(t,"__esModule",{value:!0});var n=i.getLogger("esri.core.requireUtils");t.when=function e(t,i){return r.deprecatedFunction(n,"when",{moduleName:"requireUtils",replacement:"Use `promiseUtils.create()` instead.",version:"4.10",warnOnce:!0}),Array.isArray(i)?o.create((function(e){t(i,(function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e(t)}))})):e(t,[i]).then((function(e){return e[0]}))},t.getAbsMid=function(e,t,r){return t.toAbsMid?t.toAbsMid(e):r.id.replace(/\/[^\/]*$/gi,"/")+e}}.apply(null,i))||(e.exports=o)},423:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(22),r(20),r(34),r(39),r(23),r(54)],void 0===(o=function(e,t,r,i,o,n,a,s){var p=function(e){function t(t){var r=e.call(this,t)||this;return r.attachmentTypes=null,r.attachmentsWhere=null,r.keywords=null,r.globalIds=null,r.name=null,r.num=null,r.objectIds=null,r.returnMetadata=!1,r.size=null,r.start=null,r.where=null,r}var o;return r(t,e),o=t,t.prototype.writeStart=function(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10},t.prototype.clone=function(){return new o(n.clone({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))},i([a.property({type:[String],json:{write:!0}})],t.prototype,"attachmentTypes",void 0),i([a.property({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],t.prototype,"attachmentsWhere",void 0),i([a.property({type:[String],json:{write:!0}})],t.prototype,"keywords",void 0),i([a.property({type:[Number],json:{write:!0}})],t.prototype,"globalIds",void 0),i([a.property({json:{write:!0}})],t.prototype,"name",void 0),i([a.property({type:Number,json:{read:{source:"resultRecordCount"}}})],t.prototype,"num",void 0),i([a.property({type:[Number],json:{write:!0}})],t.prototype,"objectIds",void 0),i([a.property({type:Boolean,json:{default:!1,write:!0}})],t.prototype,"returnMetadata",void 0),i([a.property({type:[Number],json:{write:!0}})],t.prototype,"size",void 0),i([a.property({type:Number,json:{read:{source:"resultOffset"}}})],t.prototype,"start",void 0),i([a.writer("start"),a.writer("num")],t.prototype,"writeStart",null),i([a.property({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],t.prototype,"where",void 0),o=i([a.subclass("esri.tasks.support.AttachmentQuery")],t)}(a.declared(o.JSONSupport));return p.from=s.default(p),p}.apply(null,i))||(e.exports=o)},424:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(22),r(20),r(48),r(34),r(39),r(23),r(54)],void 0===(o=function(e,t,r,i,o,n,a,s,p){var l=function(e){function t(t){var r=e.call(this,t)||this;return r.gdbVersion=null,r.geometryPrecision=void 0,r.historicMoment=null,r.maxAllowableOffset=void 0,r.objectIds=null,r.outFields=null,r.outSpatialReference=null,r.relationshipId=void 0,r.returnGeometry=!1,r.source=null,r.where=null,r}var n;return r(t,e),n=t,t.prototype._writeHistoricMoment=function(e,t){t.historicMoment=e&&e.getTime()},t.prototype.clone=function(){return new n(a.clone({gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&this.historicMoment.getTime(),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,returnGeometry:this.returnGeometry,source:this.source,where:this.where}))},i([s.property({type:String,json:{write:!0}})],t.prototype,"gdbVersion",void 0),i([s.property({type:Number,json:{write:!0}})],t.prototype,"geometryPrecision",void 0),i([s.property({type:Date})],t.prototype,"historicMoment",void 0),i([s.writer("historicMoment")],t.prototype,"_writeHistoricMoment",null),i([s.property({type:Number,json:{write:!0}})],t.prototype,"maxAllowableOffset",void 0),i([s.property({type:[Number],json:{write:!0}})],t.prototype,"objectIds",void 0),i([s.property({type:[String],json:{write:!0}})],t.prototype,"outFields",void 0),i([s.property({type:o.SpatialReference,json:{read:{source:"outSR"},write:{target:"outSR"}}})],t.prototype,"outSpatialReference",void 0),i([s.property({json:{write:!0}})],t.prototype,"relationshipId",void 0),i([s.property({json:{write:!0}})],t.prototype,"returnGeometry",void 0),i([s.property({json:{write:!0}})],t.prototype,"source",void 0),i([s.property({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],t.prototype,"where",void 0),n=i([s.subclass("esri.tasks.support.RelationshipQuery")],t)}(s.declared(n.JSONSupport));return l.from=p.default(l),l}.apply(null,i))||(e.exports=o)},442:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(26),r(500),r(353),r(534),r(503),r(504)],void 0===(o=function(e,t,r,i,o,n,a,s){function p(e,t){var r=e;if(t.ignoreFieldTypes&&(e=e.filter((function(e){return-1===t.ignoreFieldTypes.indexOf(e.type)}))),0===e.length)return null;var i=t.maximumFields&&e.length>t.maximumFields;return i&&(e=e.slice(0,t.maximumFields)),e===r&&(e=e.slice()),e.sort(l),{fields:e,limitExceeded:i}}function l(e,t){return"oid"===e.type?-1:"oid"===t.type?1:m(e)?-1:m(t)?1:(e.alias||e.name).toLocaleLowerCase().localeCompare((t.alias||t.name).toLocaleLowerCase())}function u(e,t){return e.editable&&-1===v.indexOf(e.type)&&!function(e,t){if(!e||!t)return!1;var r=t.creationDateField,i=t.creatorField,o=t.editDateField,n=t.editorField;return-1!==[r&&r.toLowerCase(),i&&i.toLowerCase(),o&&o.toLowerCase(),n&&n.toLowerCase()].indexOf(e.toLowerCase())}(e.name,t)}function d(e){var t=e.fields,r=e.visibleFieldNames,i=e.editFieldsInfo;return t.map((function(e){return new a({fieldName:e.name,isEditable:u(e,i),label:e.alias,format:y(e),visible:!r||r.has(e.name)})}))}function y(e){switch(e.type){case"small-integer":case"integer":case"single":return new s({digitSeparator:!0,places:0});case"double":return new s({digitSeparator:!0,places:2});case"date":return new s({dateFormat:"long-month-day-year"});default:return null}}function c(e){var t=[new n.FieldsContent,new n.AttachmentsContent];return e&&t.push(new n.TextContent({text:"<small>"+i.tooManyFields+"</small>"})),t}function f(e,t){for(var r=0,i=e;r<i.length;r++){var o=i[r];if(o&&o.valueType&&o.valueType===t)return o.name}return null}function h(e){return e&&e.length?f(e,"name-or-title")||f(e,"unique-identifier")||f(e,"type-or-category")||function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];if(i&&i.name){var o=i.name.toLowerCase();if(o.indexOf("name")>-1||o.indexOf("title")>-1)return i.name}}return null}(e):null}function m(e){return"name"===(e.name&&e.name.toLowerCase())||"name"===(e.alias&&e.alias.toLowerCase())||void 0}Object.defineProperty(t,"__esModule",{value:!0});var v=["oid","global-id","guid"];t.createPopupTemplate=function(e,t){var i=e.displayField,n=e.fields,a=e.title,s=e.visibleFieldNames,l=e.editFieldsInfo;if(!n)return null;var u=p(n,r({},g,t));if(!u)return null;var y=function(e){var t=e.titleBase,r=e.fields,i=e.displayField||h(r);return i?t+": {"+i.trim()+"}":t}({titleBase:a,fields:u.fields,displayField:i}),f=c(u.limitExceeded),m=d({fields:u.fields,visibleFieldNames:s,editFieldsInfo:l});return new o({title:y,content:f,fieldInfos:m})};var g={ignoreFieldTypes:["geometry","blob","raster","guid","xml"],maximumFields:75}}.apply(null,i))||(e.exports=o)},467:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(31),r(32),r(499),r(28),r(398)],void 0===(o=function(e,t,r,i,o,n,a){Object.defineProperty(t,"__esModule",{value:!0}),t.loadStyleRenderer=function(e,t,s){return i(this,void 0,void 0,(function(){var i,p,l;return r(this,(function(r){switch(r.label){case 0:return(i=e&&e.getAtOrigin&&e.getAtOrigin("renderer",t.origin))&&"unique-value"===i.type&&i.styleOrigin?[4,o.result(i.populateFromStyle())]:[3,2];case 1:p=r.sent(),n.throwIfAborted(s),!1===p.ok&&(l=p.error,t&&t.messages&&t.messages.push(new a("renderer:style-reference","Failed to create unique value renderer from style reference: "+l.message,{error:l,context:t})),e.clear("renderer",t.origin)),r.label=2;case 2:return[2]}}))}))}}.apply(null,i))||(e.exports=o)},484:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(22),r(20),r(197),r(461),r(34),r(39),r(23),r(525),r(394)],void 0===(o=function(e,t,r,i,o,n,a,s,p,l,u){return function(e){function t(t){var r=e.call(this,t)||this;return r.cumulative=!1,r.endField=null,r.fullTimeExtent=null,r.hasLiveData=!1,r.interval=null,r.startField=null,r.timeReference=null,r.trackIdField=null,r.useTime=!0,r}var a;return r(t,e),a=t,t.prototype.readFullTimeExtent=function(e,t){if(!t.timeExtent||!Array.isArray(t.timeExtent)||2!==t.timeExtent.length)return null;var r=t.timeExtent[0],i=t.timeExtent[1];return new o({start:r,end:i})},t.prototype.writeFullTimeExtent=function(e,t){e&&e.start&&e.end?t.timeExtent=[e.start.getTime(),e.end.getTime()]:t.timeExtent=null},t.prototype.readInterval=function(e,t){return t.timeInterval&&t.timeIntervalUnits?new n({value:t.timeInterval,unit:u.timeUnitKebabDictionary.fromJSON(t.timeIntervalUnits)}):t.defaultTimeInterval&&t.defaultTimeIntervalUnits?new n({value:t.defaultTimeInterval,unit:u.timeUnitKebabDictionary.fromJSON(t.defaultTimeIntervalUnits)}):null},t.prototype.writeInterval=function(e,t){if(e){var r=e.toJSON();t.timeInterval=r.value,t.timeIntervalUnits=r.unit}else t.timeInterval=null,t.timeIntervalUnits=null},t.prototype.clone=function(){var e=this,t=e.cumulative,r=e.endField,i=e.hasLiveData,o=e.interval,n=e.startField,p=e.timeReference,l=e.fullTimeExtent,u=e.trackIdField,d=e.useTime;return new a({cumulative:t,endField:r,hasLiveData:i,interval:o,startField:n,timeReference:s.clone(p),fullTimeExtent:s.clone(l),trackIdField:u,useTime:d})},i([p.property({type:Boolean,json:{read:{source:"exportOptions.timeDataCumulative"},write:{target:"exportOptions.timeDataCumulative"}}})],t.prototype,"cumulative",void 0),i([p.property({type:String,json:{read:{source:"endTimeField"},write:{target:"endTimeField",allowNull:!0}}})],t.prototype,"endField",void 0),i([p.property({type:o,json:{write:{enabled:!0,allowNull:!0}}})],t.prototype,"fullTimeExtent",void 0),i([p.reader("fullTimeExtent",["timeExtent"])],t.prototype,"readFullTimeExtent",null),i([p.writer("fullTimeExtent")],t.prototype,"writeFullTimeExtent",null),i([p.property({type:Boolean,json:{write:!0}})],t.prototype,"hasLiveData",void 0),i([p.property({type:n,json:{write:{enabled:!0,allowNull:!0}}})],t.prototype,"interval",void 0),i([p.reader("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],t.prototype,"readInterval",null),i([p.writer("interval")],t.prototype,"writeInterval",null),i([p.property({type:String,json:{read:{source:"startTimeField"},write:{target:"startTimeField",allowNull:!0}}})],t.prototype,"startField",void 0),i([p.property({type:l,json:{write:{enabled:!0,allowNull:!0}}})],t.prototype,"timeReference",void 0),i([p.property({type:String,json:{write:{enabled:!0,allowNull:!0}}})],t.prototype,"trackIdField",void 0),i([p.property({type:Boolean,json:{read:{source:"exportOptions.useTime"},write:{target:"exportOptions.useTime"}}})],t.prototype,"useTime",void 0),a=i([p.subclass("esri.layers.support.TimeInfo")],t)}(p.declared(a.JSONSupport))}.apply(null,i))||(e.exports=o)},485:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(22),r(20),r(34),r(23)],void 0===(o=function(e,t,r,i,o,n){Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=null,t}return r(t,e),i([n.property({type:["selection","cluster"],readOnly:!0,json:{read:!1,write:!0}})],t.prototype,"type",void 0),i([n.subclass("esri.layers.support.FeatureReduction")],t)}(n.declared(o.JSONSupport));t.FeatureReduction=a,t.default=a}.apply(null,i))||(e.exports=o)},486:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(405),r(24),r(112),r(115)],void 0===(o=function(e,t,r,i,o,n){Object.defineProperty(t,"__esModule",{value:!0});var a=i.getLogger("esri.layers.support.fieldProperties");t.defineFieldProperties=function(){return{fields:{type:[o],value:null},outFields:{type:[String],dependsOn:["fields"],json:{read:!1},set:function(e){this._userOutFields=e,this.notifyChange("outFields")},get:function(){var e=this._userOutFields;if(!e||!e.length)return null;if(r.includes(e,"*"))return["*"];if(!this.fields)return e;for(var t=0,i=e;t<i.length;t++){var o=i[t];n.hasField(this.fields,o)||a.error("field-attributes-layer:invalid-field","Invalid field "+o+" found in outFields",{layer:this,outFields:e})}return n.fixFields(this.fields,e)}}}}}.apply(null,i))||(e.exports=o)},524:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(22),r(20),r(197),r(461),r(23),r(484),r(115),r(394)],void 0===(o=function(e,t,r,i,o,n,a,s,p,l){Object.defineProperty(t,"__esModule",{value:!0}),t.TemporalLayer=function(e){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.timeExtent=null,t.timeOffset=null,t.useViewTime=!0,t}return r(t,e),t.prototype.readOffset=function(e,t){var r=t.timeInfo.exportOptions;if(!r)return null;var i=r.timeOffset,o=l.timeUnitKebabDictionary.fromJSON(r.timeOffsetUnits);return i&&o?new n({value:i,unit:o}):null},Object.defineProperty(t.prototype,"timeInfo",{set:function(e){p.fixTimeInfoFields(e,this.fields),this._set("timeInfo",e)},enumerable:!0,configurable:!0}),i([a.property({type:o,json:{write:!1}})],t.prototype,"timeExtent",void 0),i([a.property({type:n})],t.prototype,"timeOffset",void 0),i([a.reader("service","timeOffset",["timeInfo.exportOptions"])],t.prototype,"readOffset",null),i([a.property({value:null,type:s,json:{write:!0,origins:{"web-document":{read:!1,write:!1}}}})],t.prototype,"timeInfo",null),i([a.property({type:Boolean,json:{write:!1}})],t.prototype,"useViewTime",void 0),i([a.subclass("esri.layers.mixins.TemporalLayer")],t)}(a.declared(e))}}.apply(null,i))||(e.exports=o)},525:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(22),r(20),r(34),r(23)],void 0===(o=function(e,t,r,i,o,n){return function(e){function t(t){var r=e.call(this,t)||this;return r.respectsDaylightSaving=!1,r.timezone=null,r}var o;return r(t,e),o=t,t.prototype.readRespectsDaylightSaving=function(e,t){return void 0!==t.respectsDaylightSaving?t.respectsDaylightSaving:void 0!==t.respectDaylightSaving&&t.respectDaylightSaving},t.prototype.clone=function(){var e=this.respectsDaylightSaving,t=this.timezone;return new o({respectsDaylightSaving:e,timezone:t})},i([n.property({type:Boolean,json:{write:!0}})],t.prototype,"respectsDaylightSaving",void 0),i([n.reader("respectsDaylightSaving",["respectsDaylightSaving","respectDaylightSaving"])],t.prototype,"readRespectsDaylightSaving",null),i([n.property({type:String,json:{read:{source:"timeZone"},write:{target:"timeZone"}}})],t.prototype,"timezone",void 0),o=i([n.subclass("esri.layers.support.TimeReference")],t)}(n.declared(o.JSONSupport))}.apply(null,i))||(e.exports=o)},526:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(22),r(20),r(23),r(485)],void 0===(o=function(e,t,r,i,o,n){Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var r=e.call(this,t)||this;return r.type="selection",r}return r(t,e),i([o.property({type:["selection"]})],t.prototype,"type",void 0),i([o.subclass("esri.layers.support.FeatureReductionSelection")],t)}(o.declared(n.default));t.FeatureReductionSelection=a,t.default=a}.apply(null,i))||(e.exports=o)},581:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(22),r(20),r(353),r(34),r(41),r(23)],void 0===(o=function(e,t,r,i,o,n,a,s){Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){function t(t){var r=e.call(this,t)||this;return r.type="cluster",r.clusterRadius=a.toPt("80px"),r.popupTemplate=null,r}return r(t,e),i([s.property({type:["cluster"],readOnly:!0,json:{write:!0}})],t.prototype,"type",void 0),i([s.property({type:Number,cast:function(e){return"auto"===e?e:a.toPt(e)},json:{write:!0}})],t.prototype,"clusterRadius",void 0),i([s.property({type:o,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],t.prototype,"popupTemplate",void 0),i([s.subclass("esri.layers.support.FeatureReductionCluster")],t)}(s.declared(n.JSONSupport));t.FeatureReductionCluster=p,t.default=p}.apply(null,i))||(e.exports=o)},582:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(22),r(20),r(47),r(34),r(39),r(23)],void 0===(o=function(e,t,r,i,o,n,a,s){var p=new o.default({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});return function(e){function t(t){var r=e.call(this,t)||this;return r.name=null,r.description=null,r.drawingTool=null,r.prototype=null,r.thumbnail=null,r}return r(t,e),t.prototype.writeDrawingTool=function(e,t){t.drawingTool=p.toJSON(e)},t.prototype.writePrototype=function(e,t){t.prototype=a.fixJson(a.clone(e),!0)},t.prototype.writeThumbnail=function(e,t){t.thumbnail=a.fixJson(a.clone(e))},i([s.property({json:{write:!0}})],t.prototype,"name",void 0),i([s.property({json:{write:!0}})],t.prototype,"description",void 0),i([s.property({json:{read:p.read,write:p.write}})],t.prototype,"drawingTool",void 0),i([s.writer("drawingTool")],t.prototype,"writeDrawingTool",null),i([s.property({json:{write:!0}})],t.prototype,"prototype",void 0),i([s.writer("prototype")],t.prototype,"writePrototype",null),i([s.property({json:{write:!0}})],t.prototype,"thumbnail",void 0),i([s.writer("thumbnail")],t.prototype,"writeThumbnail",null),i([s.subclass("esri.layers.support.FeatureTemplate")],t)}(s.declared(n.JSONSupport))}.apply(null,i))||(e.exports=o)},583:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(386)],void 0===(o=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=/\[([^\[\]]+)\]/gi;t.reader=function(e,t,o){var n=this;return e?e.map((function(e){var a=new r;if(a.read(e,o),a.labelExpression){var s=t.fields||t.layerDefinition&&t.layerDefinition.fields||n.fields;a.labelExpression=a.labelExpression.replace(i,(function(e,t){return"["+function(e,t){if(!t)return e;for(var r=e.toLowerCase(),i=0;i<t.length;i++){var o=t[i].name;if(o.toLowerCase()===r)return o}return e}(t,s)+"]"}))}return a})):null}}.apply(null,i))||(e.exports=o)},755:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(22),r(20),r(26),r(31),r(32),r(48),r(108),r(91),r(27),r(36),r(409),r(24),r(33),r(337),r(28),r(331),r(388),r(23),r(54),r(185),r.dj.m(e)],void 0===(o=function(e,t,i,o,n,a,s,p,l,u,d,y,c,f,h,m,v,g,b,w,F,S,I){Object.defineProperty(t,"__esModule",{value:!0});var T=0,O=f.getLogger("esri.layers.graphics.sources.MemorySource"),x=function(t){function n(e){var r=t.call(this,e)||this;return r._idToClientGraphic=null,r.type="memory",r}return i(n,t),n.prototype.load=function(e){var t=h.isSome(e)?e.signal:null;return this.addResolvingPromise(this._startWorker(t)),this.when()},Object.defineProperty(n.prototype,"workerGeometryType",{get:function(){var e=this.layer&&this.layer.geometryType;return e?this._geometryTypeRequiresClientGraphicMapping(e)?"polygon":e:null},enumerable:!0,configurable:!0}),n.prototype.applyEdits=function(e){var t=this;return this.load().then((function(){return t._applyEdits(e)}))},n.prototype.openPorts=function(){var e=this;return this.load().then((function(){return e._connection.openPorts()}))},n.prototype.queryFeatures=function(e,t){var r=this;return void 0===t&&(t={}),this.load(t).then((function(){return r._connection.invoke("queryFeatures",e?e.toJSON():null,t)})).then((function(e){var t=S.fromJSON(e);if(!r._requiresClientGraphicMapping())return t;for(var i=r.layer.objectIdField,o=0,n=t.features;o<n.length;o++){var a=n[o],s=a.attributes[i],p=r._idToClientGraphic.get(s);p&&(a.geometry=p.geometry)}return t.geometryType=r.layer.geometryType,t}))},n.prototype.queryFeaturesJSON=function(e,t){var r=this;return void 0===t&&(t={}),this._requiresClientGraphicMapping()?v.reject(new d("query-features-json:unsupported","Cannot query in JSON format for client only geometry types (mesh and extent)")):this.load(t).then((function(){return r._connection.invoke("queryFeatures",e?e.toJSON():null,t)}))},n.prototype.queryFeatureCount=function(e,t){var r=this;return void 0===t&&(t={}),this.load(t).then((function(){return r._connection.invoke("queryFeatureCount",e?e.toJSON():null,t)}))},n.prototype.queryObjectIds=function(e,t){var r=this;return void 0===t&&(t={}),this.load(t).then((function(){return r._connection.invoke("queryObjectIds",e?e.toJSON():null,t)}))},n.prototype.queryExtent=function(e,t){var r=this;return void 0===t&&(t={}),this.load(t).then((function(){return r._connection.invoke("queryExtent",e?e.toJSON():null,t)})).then((function(e){return{count:e.count,extent:p.Extent.fromJSON(e.extent)}}))},n.prototype._applyEdits=function(e){var t=this;if(!this._connection)throw new d("feature-layer-source:edit-failure","Memory source not loaded");var r=this.layer.objectIdField,i=null,o=[],n=[];if(e.addFeatures&&(i=this._prepareAddFeatures(e.addFeatures)),e.deleteFeatures)for(var a=0,s=e.deleteFeatures;a<s.length;a++){"objectId"in(u=s[a])&&null!=u.objectId?o.push(u.objectId):"attributes"in u&&null!=u.attributes[r]&&o.push(u.attributes[r])}if(e.updateFeatures)for(var p=0,l=e.updateFeatures;p<l.length;p++){var u=l[p];n.push(this._serializeFeature(u))}return this._connection.invoke("applyEdits",{adds:i?i.features:[],updates:n,deletes:o}).then((function(e){var r=e.fullExtent,o=e.featureEditResults;if(t.fullExtent=r,i&&i.finish(o.uidToObjectId),t._idToClientGraphic)for(var n=0,a=o.deleteResults;n<a.length;n++){var s=a[n];s.success&&t._idToClientGraphic.delete(s.objectId)}return t._createEditsResult(o)}))},n.prototype._createEditsResult=function(e){return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}},n.prototype._createFeatureEditResult=function(e){var t=!0===e.success?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:t?new d("feature-layer-source:edit-failure",t.description,{code:t.code}):null}},n.prototype._prepareAddFeatures=function(e){for(var t=new Map,r=new Array(e.length),i=null,o=0;o<e.length;o++){var n=e[o],a=this._serializeFeature(n);!i&&h.isSome(n.geometry)&&(i=n.geometry.type),r[o]=a,t.set(""+a.uid,n)}var s=this;return{features:r,inferredGeometryType:i,finish:function(e){var r=s.sourceJSON.objectIdField;for(var i in e){var o=e[i],n=t.get(i);n&&(n.attributes||(n.attributes={}),-1===o?delete n.attributes[r]:n.attributes[r]=o,s._addIdToClientGraphic(n))}}}},n.prototype._addIdToClientGraphic=function(e){if(this._idToClientGraphic){var t=this.sourceJSON.objectIdField,r=e.attributes&&e.attributes[t];null!=r&&this._idToClientGraphic.set(r,e)}},n.prototype._requiresClientGraphicMapping=function(){var e=this.layer.geometryType||this.sourceJSON.geometryType;return this._geometryTypeRequiresClientGraphicMapping(e)},n.prototype._geometryRequiresClientGraphicMapping=function(e){return this._geometryTypeRequiresClientGraphicMapping(e.type)},n.prototype._geometryTypeRequiresClientGraphicMapping=function(e){return"mesh"===e||"multipatch"===e||"extent"===e},n.prototype._serializeFeature=function(e){var t=e.attributes,r=this._geometryForSerialization(e),i=(T++).toString();return r?{uid:i,geometry:r.toJSON(),attributes:t}:{uid:i,attributes:t}},n.prototype._geometryForSerialization=function(e){var t=e.geometry;return h.isNone(t)?null:this._geometryRequiresClientGraphicMapping(t)?p.Polygon.fromExtent(t.extent):t},n.prototype._startWorker=function(t){return s(this,void 0,void 0,(function(){var i,o,n,s,l,u,d,c,f,h,m,w,F,S,T,x;return a(this,(function(a){switch(a.label){case 0:return y("esri-webpack")?[4,v.create((function(e){return Promise.all([r.e(8),r.e(12),r.e(13),r.e(105)]).then(function(){var t=[r(1149)];e.apply(null,t)}.bind(this)).catch(r.oe)}))]:[3,2];case 1:a.sent(),a.label=2;case 2:return i=this,[4,b.open(g.getAbsMid("./support/MemorySourceWorker",e,I),{strategy:y("esri-workers-for-memory-layers")?"dedicated":"local",signal:t})];case 3:return i._connection=a.sent(),o=this.layer,n=o.fields,s=o.spatialReference,l=o.objectIdField,u=o.hasM,d=o.hasZ,c=o.timeInfo,f="defaults"===this.layer.originOf("spatialReference"),h=this._prepareAddFeatures(this.items),this.on("before-changes",(function(e){O.error("Source modifications will not propagate after layer has been loaded. Please use .applyEdits() instead"),e.preventDefault()})),m={features:h.features,fields:n&&n.map((function(e){return e.toJSON()})),geometryType:p.typeKebabDictionary.toJSON(this.workerGeometryType),hasM:u,hasZ:d,objectIdField:l,spatialReference:f?null:s&&s.toJSON(),timeInfo:c?c.toJSON():null},[4,this._connection.invoke("load",m,{signal:t})];case 4:for(w=a.sent(),F=0,S=w.warnings;F<S.length;F++)T=S[F],O.warn(T.message,{layer:this.layer,warning:T});return w.featureErrors.length&&O.warn("Encountered "+w.featureErrors.length+" validation errors while loading features",w.featureErrors),x=w.layerDefinition,this._geometryTypeRequiresClientGraphicMapping(h.inferredGeometryType)&&(x.geometryType=p.typeKebabDictionary.toJSON(h.inferredGeometryType)),this.sourceJSON=x,this._requiresClientGraphicMapping()&&(this._idToClientGraphic=new Map),h.finish(w.assignedObjectIds),[2]}}))}))},o([w.shared({Type:l,ensureType:F.ensureType(l)})],n.prototype,"itemType",void 0),o([w.property()],n.prototype,"type",void 0),o([w.property({constructOnly:!0})],n.prototype,"layer",void 0),o([w.property({readOnly:!0,dependsOn:["layer.geometryType"]})],n.prototype,"workerGeometryType",null),o([w.property()],n.prototype,"sourceJSON",void 0),o([w.subclass("esri.layers.graphics.sources.MemorySource")],n)}(w.declared(c.LoadableMixin(m.EsriPromiseMixin(u))));t.MemorySource=x,t.default=x}.apply(null,i))||(e.exports=o)},756:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(22),r(20),r(34),r(23)],void 0===(o=function(e,t,r,i,o,n){Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){return e.call(this,t)||this}var o;return r(t,e),o=t,t.prototype.clone=function(){var e=this,t=e.name,r=e.fields,i=e.isAscending,n=e.isUnique,a=e.description;return new o({name:t,fields:r,isAscending:i,isUnique:n,description:a})},i([n.property({constructOnly:!0})],t.prototype,"name",void 0),i([n.property({constructOnly:!0})],t.prototype,"fields",void 0),i([n.property({constructOnly:!0})],t.prototype,"isAscending",void 0),i([n.property({constructOnly:!0})],t.prototype,"isUnique",void 0),i([n.property({constructOnly:!0})],t.prototype,"description",void 0),o=i([n.subclass("esri.layers.support.FeatureIndex")],t)}(n.declared(o.JSONSupport));t.FeatureIndex=a,t.default=a}.apply(null,i))||(e.exports=o)},757:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(27),r(352),r(485),r(581),r(526)],void 0===(o=function(e,t,r,i,o,n,a){function s(e,t,i){return e?"selection"!==e.type?(i.messages&&i.messages.push(new r("featureReduction:unsupported","FeatureReduction of type '"+e.declaredClass+"' are not supported in scenes.",{featureReduction:e,context:i})),null):e.write(t,i):null}Object.defineProperty(t,"__esModule",{value:!0}),t.webSceneFeatureReductionTypes={key:"type",base:o.default,typeMap:{selection:a.default}},t.read=function(e,t,r){var i=(t=t.layerDefinition||t).featureReduction;if(i)switch(i.type){case"selection":return a.default.fromJSON(i);case"cluster":return n.default.fromJSON(i)}return null},t.writeTarget=function(e,t,r,o){var n=s(e,{},o);n&&i.setDeepValue(r,n,t)},t.write=s}.apply(null,i))||(e.exports=o)},758:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(22),r(20),r(34),r(39),r(23),r(354),r(582)],void 0===(o=function(e,t,r,i,o,n,a,s,p){return function(e){function t(t){var r=e.call(this,t)||this;return r.id=null,r.name=null,r.domains=null,r.templates=null,r}return r(t,e),t.prototype.readDomains=function(e){var t={};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];switch(i.type){case"range":t[r]=s.RangeDomain.fromJSON(i);break;case"codedValue":t[r]=s.CodedValueDomain.fromJSON(i);break;case"inherited":t[r]=s.InheritedDomain.fromJSON(i)}}return t},t.prototype.writeDomains=function(e,t){var r={};for(var i in e)e.hasOwnProperty(i)&&(r[i]=e[i]&&e[i].toJSON());n.fixJson(r),t.domains=r},t.prototype.readTemplates=function(e){return e&&e.map((function(e){return new p(e)}))},t.prototype.writeTemplates=function(e,t){t.templates=e&&e.map((function(e){return e.toJSON()}))},i([a.property({json:{write:!0}})],t.prototype,"id",void 0),i([a.property({json:{write:!0}})],t.prototype,"name",void 0),i([a.property({json:{write:!0}})],t.prototype,"domains",void 0),i([a.reader("domains")],t.prototype,"readDomains",null),i([a.writer("domains")],t.prototype,"writeDomains",null),i([a.property({json:{write:!0}})],t.prototype,"templates",void 0),i([a.reader("templates")],t.prototype,"readTemplates",null),i([a.writer("templates")],t.prototype,"writeTemplates",null),i([a.subclass("esri.layers.support.FeatureType")],t)}(a.declared(o.JSONSupport))}.apply(null,i))||(e.exports=o)},759:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(22),r(20),r(47),r(34),r(23)],void 0===(o=function(e,t,r,i,o,n,a){var s=new o.default({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"});return function(e){function t(t){var r=e.call(this,t)||this;return r.cardinality=null,r.id=null,r.keyField=null,r.name=null,r.relatedTableId=null,r}return r(t,e),i([a.property({json:{read:s.read,write:s.write}})],t.prototype,"cardinality",void 0),i([a.property({json:{read:!0,write:!0}})],t.prototype,"id",void 0),i([a.property({json:{read:!0,write:!0}})],t.prototype,"keyField",void 0),i([a.property({json:{read:!0,write:!0}})],t.prototype,"name",void 0),i([a.property({json:{read:!0,write:!0}})],t.prototype,"relatedTableId",void 0),i([a.subclass("esri.layers.support.Relationship")],t)}(a.declared(n.JSONSupport))}.apply(null,i))||(e.exports=o)}}]);
//# sourceMappingURL=4.a2f91caf.chunk.js.map